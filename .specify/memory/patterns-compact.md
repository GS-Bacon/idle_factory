# デザインパターン集（圧縮版）

## 凡例
✓=必須 △=推奨 ✗=避ける

---

## 進行(P)
|ID|名称|原則|チェック|
|--|---|---|--------|
|P1|段階的複雑化|新システムは小→大|初レシピ1-2入力,派生順|
|P2|明確マイルストーン|常に次目標認識|各Phase目標,達成FB|
|P3|複数経路|迂回路用意|2+ルート,ボトルネック回避|
|P4|報酬即時性|結果すぐ見える|配置→動作,30秒内成果|

## レシピ(R)
|ID|名称|原則|チェック|
|--|---|---|--------|
|R1|入出力バランス|副産物に消費先|全副産物用途,速度均衡|
|R2|比率美学|計算しやすい|整数比,端数なし|
|R3|深さ制限|Tier毎に区切り|中間材でリセット|
|R4|視認性|関係視覚化|ツリー表示,逆引き可|

## クエスト(Q)
|ID|名称|原則|チェック|
|--|---|---|--------|
|Q1|自然誘導|強制なし|ヒント系,スキップ可|
|Q2|文脈報酬|次段階で役立つ|報酬→次クエで使用|
|Q3|探索連鎖|発見が発見呼ぶ|各発見に次ヒント|
|Q4|失敗許容|やり直し容易|チェックポイント,ペナ軽|

## UI/UX(U)
|ID|名称|原則|チェック|
|--|---|---|--------|
|U1|情報階層|重要→詳細|一次/二次/三次情報|
|U2|操作FB|全操作に応答|視覚+音,0.1秒以内|
|U3|元に戻す|ミス回復容易|Undo,確認ダイアログ|
|U4|状態可視|システム状態表示|電力,在庫,エラー|

## エディタ(E)
|ID|名称|原則|チェック|
|--|---|---|--------|
|E1|即時プレビュー|編集→即反映|リアルタイム更新|
|E2|非破壊編集|元データ保持|履歴,ブランチ|
|E3|制約視覚化|配置ルール表示|有効/無効領域|
|E4|スマートデフォルト|妥当な初期値|コンテキスト依存|
|E5|一括操作|複数同時編集|選択→操作|
|E6|参照整合性|削除時チェック|使用箇所警告|

## テスト(T)
|ID|名称|用途|実装|
|--|---|---|-----|
|T1|スナップショット|UI回帰|出力比較|
|T2|ファズ|境界値|ランダム入力|
|T3|プロパティ|不変条件|QuickCheck|
|T4|シミュレーション|長時間安定|加速テスト|

## サウンド(S)
|ID|名称|原則|実装|
|--|---|---|-----|
|S1|ミキシング階層|優先度制御|Master/Music/SFX/Voice|
|S2|反復疲労防止|バリエーション|3+クリップ,ピッチ変化|
|S3|空間オーディオ|距離減衰|min/max距離,rolloff|
|S4|アクセシビリティ|字幕/視覚化|オプション提供|

## グラフィック(G)
|ID|名称|原則|実装|
|--|---|---|-----|
|G1|LOD|距離適応|Full/Med/Low/Icon|
|G2|インスタンシング|大量描画|1コールで数千個|
|G3|カリング|不可視除外|フラスタム+オクルージョン|
|G4|シェーダー管理|スタッター防止|プリコンパイル,キャッシュ|

## ネットワーク(N)
|ID|名称|原則|実装|
|--|---|---|-----|
|N1|サーバー権威|重要ロジックはサーバー|位置/HP/インベントリ|
|N2|クライアント予測|入力即時反映→後で修正|pending_inputs管理|
|N3|帯域最適化|差分のみ送信|delta+interest管理|
|N4|再接続処理|状態復元|セッション維持,フル同期|

## セキュリティ(C)
|ID|名称|原則|実装|
|--|---|---|-----|
|C1|多層防御|複数レイヤー|権威/検証/検知/ログ|
|C2|入力検証|全入力チェック|速度/範囲/レート|
|C3|セーブ保護|暗号化|AES-256-GCM|

## MOD(M)
|ID|名称|原則|実装|
|--|---|---|-----|
|M1|データライフサイクル|3段階|Settings→Data→Runtime|
|M2|サンドボックス|危険API禁止|os/io/load無効|
|M3|バージョニング|SemVer|非推奨→削除パス|

## レベルデザイン(L)
|ID|名称|原則|実装|
|--|---|---|-----|
|L1|進行フェーズ|学習→戦略→拡張→マスタリー|時間ベース区切り|
|L2|探索報酬|発見にインセンティブ|リソース/技術/ロア|
|L3|待機時間管理|代替タスク|探索/最適化/計画|

## Bevy ECS(B)
|ID|名称|原則|実装|
|--|---|---|-----|
|B1|コンポーネント分割|小さく単一責任|Position,Velocity別|
|B2|システム順序|依存明示|.chain()/.after()|
|B3|変更検出|差分処理|Changed<T>/Added<T>|

## Rust(RS)
|ID|名称|原則|実装|
|--|---|---|-----|
|RS1|所有権活用|clone避ける|参照/Cow/Arc|
|RS2|アロケーション最小化|再利用|Vec::with_capacity,pool|
|RS3|エラーハンドリング|unwrap避ける|Result/Option/?演算子|

## アクセシビリティ(A)
|ID|名称|対応|実装|
|--|---|---|-----|
|A1|視覚|色覚/コントラスト|モード切替,4.5:1以上|
|A2|聴覚|字幕/視覚化|オプション,方向表示|
|A3|運動|リマップ/補助|全キー変更可,ホールド/トグル|

## ローカライズ(I)
|ID|名称|原則|実装|
|--|---|---|-----|
|I1|文字列外部化|ハードコード禁止|fluent/i18n|
|I2|レイアウト対応|拡張考慮|30%余白,RTL対応|

---

## アンチパターン速見表

### 致命的(即修正)
|分野|パターン|対策|
|----|--------|-----|
|進行|いきなり複雑|段階的導入|
|レシピ|副産物詰まり|消費先追加|
|UI|操作無反応|0.1秒内FB|
|ネットワーク|クライアント信頼|サーバー権威|
|セキュリティ|平文セーブ|暗号化|
|グラフィック|シェーダースタッター|プリコンパイル|
|サウンド|単一サンプル繰返し|バリエーション|

### 重大(早期対応)
|分野|パターン|対策|
|----|--------|-----|
|進行|ボトルネック1箇所|複数経路|
|テスト|UIテストなし|スナップショット|
|ECS|巨大コンポーネント|分割|
|Rust|過剰clone|参照活用|

---

## 評価テンプレート

```
機能: [名称]
日付: [YYYY-MM-DD]

適合パターン: P1,R2,U1...
違反パターン: なし/[ID]

問題点:
1.

対策:
1.

総合: OK/要修正
```
