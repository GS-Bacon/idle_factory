# プロジェクト憲章 (Constitution)

> このファイルはプロジェクトの根本原則を定義する。変更には十分な理由が必要。

## 禁止事項（MUST NOT）

| 禁止 | 理由 |
|------|------|
| ゲーム本体へのLua/WASM統合 | 複雑さに見合わない |
| Resourceでのプレイヤーデータ管理 | マルチプレイ不可になる |
| ハードコードされたロジック | Mod対応不可 |
| 後方互換性ハック | 既存プレイヤーなし |

---

## ゲームアイデンティティ

| 項目 | 内容 |
|------|------|
| **ジャンル** | 3Dボクセル工場自動化ゲーム |
| **技術** | Rust + Bevy 0.15 |
| **プラットフォーム** | PC (Windows/Linux/Mac) + WASM |
| **ターゲット** | Factorio/Satisfactory/Minecraftが好きな人 |

## コア原則

### 1. ストレスフリー設計

| ルール | 理由 |
|--------|------|
| 敵Mobなし | 建設に集中 |
| HP/空腹/落下ダメージなし | 管理コストなし |
| 資源枯渇なし | 長期プレイ可能 |
| 電力不足でも壊れない | 減速するだけ |

### 2. 自動化ファースト

機械による自動生産 → コンベアによる自動輸送 → 手動操作は最小限

### 3. Minecraft風UX

一人称ボクセル / WASD + マウス / 1m³ブロック / ホットバー + グリッド

## 確定した技術設計

| 判断 | 決定 | 理由 |
|------|------|------|
| **ID方式** | 動的ID + Phantom Type | 型安全 + Mod対応 |
| **スクリプト** | 外部API（WebSocket） | Lua/WASM統合しない |
| **マルチ** | Component化必須 | 後からは困難 |
| **イベント** | Bevy Observer | マルチ・Mod・デバッグ全てに必要 |

## Single Source of Truth

| データ種別 | 定義場所 |
|-----------|----------|
| アイテム | `src/game_spec/registry.rs` |
| 機械 | `src/game_spec/machines.rs` |
| レシピ | `src/game_spec/recipes.rs` |
| クエスト | `src/game_spec/quests.rs` |

## コード品質基準

| 基準 | 値 |
|------|-----|
| テストカバレッジ | 重要パス100% |
| unwrap() | テスト以外では expect() 必須 |
| Clippy/コンパイル警告 | 0件 |

## 開発フロー

```
仕様確認 → テスト作成 → 実装 → E2E確認 → コミット
```

**バグ修正の鉄則**: 再現テストを先に書く

---

*最終更新: 2026-01-30*
