# プロジェクト憲章 (Constitution)

> このファイルはプロジェクトの根本原則を定義する。変更には十分な理由が必要。

## ゲームアイデンティティ

| 項目 | 内容 |
|------|------|
| **ジャンル** | 3Dボクセル工場自動化ゲーム |
| **技術** | Rust + Bevy 0.15 |
| **プラットフォーム** | PC (Windows/Linux/Mac) + WASM |
| **ターゲット** | Factorio/Satisfactory/Minecraftが好きな人 |

## コア原則（不変）

### 1. ストレスフリー設計

| ルール | 理由 |
|--------|------|
| 敵Mobなし | 建設に集中できる |
| HPなし | 死の心配なし |
| 空腹なし | 管理コストなし |
| 落下ダメージなし | 自由な移動 |
| 資源枯渇なし | 長期プレイ可能 |
| 電力不足でも壊れない | 減速するだけ |

### 2. 自動化ファースト

| 優先順位 | 内容 |
|----------|------|
| 1 | 機械による自動生産 |
| 2 | コンベアによる自動輸送 |
| 3 | プレイヤーの手動操作は最小限 |

### 3. Minecraft風UX

| 要素 | 仕様 |
|------|------|
| 視点 | 一人称ボクセル |
| 操作 | WASD + マウス |
| ブロック | 1m³単位で配置 |
| インベントリ | ホットバー + グリッド |

## 確定した技術設計（変更困難）

`.claude/architecture-future.md` より抜粋:

| 判断 | 決定 | 理由 |
|------|------|------|
| **ID方式** | 動的ID + Phantom Type | 型安全 + Mod対応 |
| **スクリプト** | 外部API（WebSocket） | Lua/WASM統合しない |
| **マルチ** | 確定実装、Component化必須 | 後からは困難 |
| **イベント** | 全フック（Bevy Observer） | マルチ・Mod・デバッグ全てに必要 |

## データ駆動設計

### Single Source of Truth

| データ種別 | 定義場所 |
|-----------|----------|
| アイテム定義 | `src/game_spec/registry.rs` |
| 機械定義 | `src/game_spec/machines.rs` |
| レシピ定義 | `src/game_spec/recipes.rs` |
| クエスト定義 | `src/game_spec/quests.rs` |

### 新コンテンツ追加の原則

```
新機械を追加したい
  → MachineSpec を定義するだけ
  → UI、tick処理、コンベア接続は自動
  → テストで網羅性を保証
```

## コード品質基準

| 基準 | 値 |
|------|-----|
| テストカバレッジ | 重要パスは100% |
| unwrap() | テスト以外では expect() 必須 |
| Clippy警告 | 0件 |
| コンパイル警告 | 0件 |

## 禁止事項

| 禁止 | 理由 |
|------|------|
| ゲーム本体へのLua/WASM統合 | 複雑さに見合わない |
| Resourceでのプレイヤーデータ管理 | マルチプレイ不可になる |
| ハードコードされたロジック | Mod対応不可 |
| 後方互換性ハック | 既存プレイヤーなし |

## 開発フロー

```
仕様確認 → テスト作成 → 実装 → E2E確認 → コミット
```

**バグ修正の鉄則**: 再現テストを先に書く

---

*最終更新: 2026-01-07*
