# Development Changelog

最新の開発履歴。詳細は git log 参照。

---

## 2025-12-23

### ポーズメニュー・プロファイルシステム実装

**新機能**

- ポーズメニュー: ESCでゲーム中断、Resume/Save&Quit/MainMenu
- プロファイル選択画面: MOD/データプロファイルの選択
- プロファイル設定画面: プロファイル管理の説明

**ESCキー対応**

- InGame → PauseMenu → InGame（トグル）
- 各メニュー画面から前画面に戻れる

### ゲームステート制御の改善

**修正内容**

- HUD: クロスヘアをInGame時のみ表示、CrosshairRootマーカー追加
- 納品プラットフォーム: InGameステートでのみシステム実行
- マシンシステム: InGameステートでのみ実行
- インベントリUI: ホットバーHUDの表示/非表示ロジック改善
- サウンド: SoundCategoryのDefault実装をderiveに変更
- アクセシビリティ: 高コントラストモードの色変換修正

**テスト**: 109件すべて成功

---

## 2025-12-22

### 仕様に基づく実装

**新規モジュール**:
- `src/core/encryption.rs` - AES-256-GCM暗号化 (C3)
  - セーブデータ保護、Steam実績改ざん防止
  - encrypt/decrypt関数、JSON対応
- `src/core/accessibility.rs` - アクセシビリティ (A1-A3)
  - 色覚モード (P/D/T型、高コントラスト)
  - UIスケール、字幕、視覚音響インジケーター
  - 入力モード (ホールド/トグル)、感度調整
  - プリセット (視覚/聴覚/運動障害)
- `src/core/sound.rs` - サウンドシステム (S1-S4)
  - ミキシング階層 (Master > Music/SFX/Voice)
  - ピッチバリエーション (±10%)
  - 空間オーディオ、同時再生数制限
  - カテゴリ別ボリューム
- `src/ui/feedback.rs` - UIフィードバック (U2)
  - 視覚フィードバック (フラッシュ、テキスト)
  - 音声フィードバック
  - 成功/失敗/警告の区別

**更新**:
- `Cargo.toml`: aes-gcm, rand, base64 追加
- `API_REFERENCE.md`: 新モジュール追記

### 仕様変更（デザインパターン適用）
52パターンに基づき仕様を更新。詳細: `spec-change-report-2025-12-22.md`

**追加仕様**:
- サウンドシステム (S1-S4)
- アクセシビリティ拡張 (A1-A3)
- ローカライズ対応 (I1-I2)
- セーブ暗号化 (C3)
- UI応答時間要件 (U2)
- レシピ設計ガイドライン (R1-R4)
- 進行フェーズ設計 (P1-P4, L1-L3)
- テスト戦略拡張 (T1-T4)
- エディタUX原則 (E1-E6)
- マルチプレイヤー詳細 (N1-N4)

**更新ファイル**: constitution.md, core-game-mechanics.md, steam-editor-mode.md

### ドキュメント圧縮
- `patterns-compact.md`: 52パターンを表形式に圧縮
- `index-compact.md`: 全仕様を1ファイルに集約
- `.claude/skills/index.md`: スキルを統合
- 冗長ファイル削除

### 大規模調査完了
- 10レポート作成（マルチプレイ、セキュリティ、UI、MOD、レベルデザイン、Bevy、Rust、アクセシビリティ等）
- 52デザインパターン策定

---

## 2025-12-22（Earlier）

### アーキテクチャ実装
- 共通型crate作成 (factory-data-types)
- YAML統一、ホットリロード対応
- TypeScript型自動生成 (ts-rs)

### Steam/エディタ仕様
- 実績システム設計
- MOD/プロファイルシステム
- プロファイル直接編集方式

### 研究完了
- 工場ゲームUX（Factorio, Satisfactory分析）
- エディタUX（Unity, Blender, MagicaVoxel）
- テスト手法（Bevy, Tauri, E2E）
- サウンド/グラフィック実装

---

## Phase完了状況

|Phase|内容|状態|
|-----|----|----|
|1|コアエンジン、MOD基盤|✅|
|2|ロジック、物流シミュレーション|✅|
|3|電力、マルチブロック|✅|
|4|スクリプト、シグナル|✅|
|5|最適化、MODローダー|✅|
|Menu|メインメニュー、セーブ|✅|

---

## 実装済みシステム

### コア
- YAML/Luaホットリロード
- 32³チャンク + Greedy Meshing
- LOD (4段階)
- 非同期チャンク生成

### ゲームプレイ
- 電力ネットワーク (BFS)
- マルチブロック検証
- Luaスクリプト (サンドボックス)
- シグナル/ロジックゲート
- インベントリ (40スロット)
- クエスト/納品プラットフォーム
- 天候/昼夜サイクル
- 液体/熱/振動システム

### UI
- Minecraft風インベントリ
- 機械GUI
- ミニマップ/HP/クエストHUD
- 設定UI

### エディタ (Factory Data Architect)
- アイテム/レシピ/クエスト編集
- マルチブロック3D編集
- バイオーム/サウンド編集
- YAMLエクスポート

---

## テスト状況
- 全テスト: 90+件パス
- コアシステム: 90%+カバレッジ
- Clippy警告: 0

---

*git log で完全な履歴を確認可能*
