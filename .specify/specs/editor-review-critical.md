# エディタ仕様レビュー（批判的視点・MOD開発者視点）

## 総評

基本的なエディタ構成は良いが、**連携の詳細**と**MOD開発者向けワークフロー**が不足。

---

## 🔴 仕様の矛盾・不整合

### 1. Machinesタブの定義場所

| 記載場所 | 内容 |
|----------|------|
| editor.md | Machinesタブの説明あり |
| index-compact.md | `items:... | recipes:...` にMachinesの記載なし |

**→ Machinesタブは存在するのか不明**

### 2. エディタでの「テストプレイ」仕様

> 「エディタで「テストプレイ」ボタン → 現在の編集データでゲーム起動」

- セーブデータはどうなる？
- 既存ワールドでテスト？新規ワールド？
- テスト用アイテム付与機能は？

---

## 🟡 仕様が足りない・曖昧

### 1. ホットリロードの技術詳細

| 未定義事項 | なぜ重要か |
|------------|-----------|
| ファイルウォッチの仕組み | fsnotify? polling? |
| 検知から反映までの遅延 | 体感で何秒？ |
| 無効なYAML保存時の動作 | クラッシュ？無視？エラー表示？ |
| 部分リロード vs 全リロード | パフォーマンス影響 |

### 2. コンフリクト処理

ゲームとエディタで同時編集した場合：

| シナリオ | 現仕様 | 必要な仕様 |
|----------|--------|-----------|
| エディタ保存中にゲームがファイル読み込み | 未定義 | ロック or リトライ |
| ゲームがセーブ中にエディタが読み込み | 未定義 | 排他制御 |
| 両方で同じレシピを編集 | 未定義 | 警告 or 自動マージ |

### 3. 検証機能の不足

MOD開発者が最も必要とする機能：

| 検証項目 | 現状 | 必要 |
|----------|------|------|
| レシピの循環依存 | なし | 検出してエラー |
| 到達不能なアイテム | なし | 全アイテムが生産可能か |
| クエスト依存の孤立 | なし | 全クエストが到達可能か |
| 消費電力のバランス | なし | ティアごとの電力収支 |
| レシピチェーンの可視化 | なし | 原料→最終製品の依存グラフ |

### 4. デバッグ機能

テストプレイ時に必要：

| 機能 | 用途 |
|------|------|
| アイテム付与 | 任意のアイテムをインベントリに |
| クエストスキップ | 特定クエスト状態にジャンプ |
| 時間操作 | 昼夜・天候を変更 |
| 電力無限モード | 電力テストを簡略化 |
| テレポート | 特定座標に移動 |

### 5. バージョン管理連携

| 機能 | 用途 |
|------|------|
| Git連携 | コミット、差分表示 |
| ブランチ切替 | 複数バージョンを管理 |
| コンフリクトマーカー | マージ時の衝突解決 |
| .gitignore生成 | ビルド成果物を除外 |

---

## 🟠 MOD開発者視点での不安・懸念

### 1. 学習曲線

> エディタの使い方ドキュメントがない

- チュートリアル/ウォークスルーは？
- サンプルMODは付属する？
- よくあるエラーと解決策は？

### 2. テンプレート機能

> 既存のレシピ/機械をベースに新規作成できる？

| 欲しい機能 | 理由 |
|------------|------|
| 既存アイテムを複製 | ゼロから作るより早い |
| テンプレートから新規 | バニラの精錬炉をベースに |
| プリセット | 「高速機械」「低電力機械」など |

### 3. コンベアレイアウトのプレビュー

> レシピを見ながら「これを作るのに必要な機械配置」をプレビューしたい

Factorioの「Alt表示」的な：
- 1つの製品に必要な機械数
- 必要な入力コンベアレーン数
- 電力消費の概算

### 4. MOD間依存関係

```yaml
dependencies:
  - base: ">=1.0.0"
```

これだけでは不十分：

| 問題 | 対策 |
|------|------|
| 依存MODがない場合 | 起動前に警告、ダウンロードリンク |
| バージョン非互換 | 具体的な何が壊れるかを表示 |
| 循環依存 | 検出してエラー |
| 任意依存（optional） | あれば機能追加、なくても動く |

### 5. MOD公開ワークフロー

| ステップ | 現仕様 | 必要な仕様 |
|----------|--------|-----------|
| パッケージング | エクスポート | ✓ |
| バージョニング | manifest.yaml | ✓ |
| 公開先 | 未定義 | Steam Workshop? 独自サイト? |
| 自動テスト | 未定義 | CI/CD連携 |
| ライセンス | 未定義 | CC? MIT? 選択可能に |

---

## 🔵 ゲーム・エディタ連携で浮いている仕様

### 1. ゲーム内エディタとの関係

> ゲーム本体にもブループリント機能がある

- エディタで作ったマルチブロック定義 → ゲーム内で設置
- ゲーム内で作ったブループリント → エディタで編集？

**連携が不明確**

### 2. Luaスクリプトの編集

> エディタでLuaを編集する機能がない

- scripts/フォルダに入れるだけ？
- シンタックスハイライト？
- ゲームAPIの補完？
- デバッグ実行？

### 3. 3Dモデルの編集

> models/フォルダに入れるだけ？

- プレビュー機能は？
- アニメーション確認は？
- インポート形式は何がサポート？（GLTF以外は？）

---

## 📋 まとめ：優先対処リスト

| 優先度 | 問題 | 対処 | 状態 |
|--------|------|------|------|
| 高 | ホットリロード詳細 | 技術仕様を追記 | ✅ 完了 |
| 高 | エラー処理 | 無効YAML時の動作を定義 | ✅ 完了 |
| 高 | テストプレイ詳細 | セーブデータ・デバッグ機能を定義 | ✅ 完了 |
| 中 | 検証機能 | 循環依存・到達可能性チェック | ✅ 完了 |
| 中 | テンプレート機能 | 複製・プリセットを追加 | ✅ 完了 |
| 中 | Luaエディタ連携 | 最低限の編集環境 | ✅ 完了 |
| 中 | ゲーム⇔エディタ連携 | ブループリント連携を追記 | ✅ 完了 |
| 低 | バージョン管理連携 | Git連携オプション | 未着手 |
| 低 | MOD公開ワークフロー | 公開先・CI連携 | 未着手 |

---

## 💡 競合エディタとの比較

| 機能 | Factorioデータ編集 | 本エディタ | 評価 |
|------|-------------------|-----------|------|
| ビジュアル編集 | なし（テキスト） | あり（Tauri/React） | ✅ 優位 |
| ホットリロード | あり | あり | 同等 |
| 検証機能 | 起動時チェック | 未定義 | 要追加 |
| デバッグコンソール | あり（/c コマンド） | 未定義 | 要追加 |
| MOD公開 | MODポータル連携 | 未定義 | 要追加 |

本エディタの強み：
- ビジュアル編集でテキスト知識不要
- マルチブロックの3D編集
- レシピのノードベース編集

活かすべき方向性：**非プログラマでもMODを作れる**
