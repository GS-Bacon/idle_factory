# マルチブロックシステム

## 概要

複数ブロックを組み合わせて1つの大型機械を形成。
Create Mod / GregTech風のシステム。

## 基本仕様

| 項目 | 値 |
|------|-----|
| 形成方法 | パターン通りにブロック配置 → レンチで確定 |
| 解除方法 | コントローラーブロックをレンチで解除 |
| 入出力 | 専用のハッチ/バスブロック |

## 形成の流れ

```
1. ブロックを配置（フレーム、壁、ハッチ等）
2. コントローラーブロックを設置
3. レンチでコントローラーを右クリック
4. パターン検証
   - 成功 → 形成エフェクト、機械として稼働開始
   - 失敗 → エラー表示（どこが間違っているか）
```

## 構成ブロック

| ブロック種類 | 役割 |
|--------------|------|
| コントローラー | 機械の中核、UI表示 |
| フレーム | 骨格、必須 |
| ケーシング | 壁、必須 |
| 入力ハッチ | アイテム入力 |
| 出力ハッチ | アイテム出力 |
| 液体入力ハッチ | 液体入力 |
| 液体出力ハッチ | 液体出力 |
| エネルギーハッチ | 電力供給 |
| メンテナンスハッチ | 修理/メンテナンス用 |

## マルチブロック機械一覧

### 大型精錬炉

| 項目 | 値 |
|------|-----|
| サイズ | 3×3×3 |
| 効果 | 精錬速度4倍、燃料効率2倍 |
| 必要ブロック | コントローラー×1、フレーム×8、ケーシング×18、ハッチ類 |

```
[ケ][ケ][ケ]     ケ = ケーシング
[ケ][コ][ケ]     コ = コントローラー
[ケ][入][出]     入 = 入力ハッチ、出 = 出力ハッチ

(断面図、高さ3段積み)
```

### 大型組立機

| 項目 | 値 |
|------|-----|
| サイズ | 5×3×5 |
| 効果 | 8レシピ同時処理、速度2倍 |
| 特徴 | 複数種類のアイテムを並列生産 |

### 原子炉

| 項目 | 値 |
|------|-----|
| サイズ | 5×5×5 |
| 発電量 | 2,500kW |
| 特徴 | 冷却システム必須 |

### 蒸留塔

| 項目 | 値 |
|------|-----|
| サイズ | 3×9×3（縦長） |
| 効果 | 原油を複数の製品に分留 |
| 出力 | 燃料、潤滑油、アスファルト等 |

### 宇宙ステーション部品製造機

| 項目 | 値 |
|------|-----|
| サイズ | 7×5×7 |
| 効果 | 最終目標の部品を製造 |
| 特徴 | ゲーム最大の機械 |

## エラー表示

形成失敗時は具体的なエラーを表示。

| エラー | 説明 |
|--------|------|
| 「ブロック不足: ケーシング (2,3,1)」 | 座標(2,3,1)にケーシングがない |
| 「不正なブロック: (1,2,0) に鉄ブロック」 | 間違ったブロックがある |
| 「ハッチ不足: 入力ハッチが必要」 | 必須ハッチがない |
| 「電力供給なし」 | エネルギーハッチがない |

## プレビュー機能

コントローラーを持って設置位置を見ると：
- 必要なブロック配置をホログラム表示
- 正しい位置 = 緑
- 間違い/不足 = 赤

## ハッチの共有

複数のハッチを設置可能。

| 用途 | 効果 |
|------|------|
| 入力ハッチ複数 | 複数種類のアイテムを別々に投入 |
| 出力ハッチ複数 | 出力を分散、詰まり防止 |
| エネルギーハッチ複数 | 電力供給を分散 |

## MOD/エディタ対応

マルチブロックのパターンはエディタで定義可能。

```yaml
# multiblock_definition.yaml
id: large_smelter
name: 大型精錬炉
size: [3, 3, 3]
controller: [1, 1, 0]  # コントローラーの位置
pattern:
  - layer: 0  # 底面
    rows:
      - "CCC"
      - "CCC"
      - "CIC"  # I = 入力ハッチ
  - layer: 1  # 中間
    rows:
      - "CCC"
      - "C C"  # 空洞
      - "CCC"
  - layer: 2  # 上面
    rows:
      - "CCC"
      - "CKC"  # K = コントローラー
      - "COC"  # O = 出力ハッチ
legend:
  C: casing_block
  I: input_hatch
  O: output_hatch
  K: controller
  " ": air
```

## 設計思想

| ポイント | 理由 |
|----------|------|
| レンチで確定 | 誤形成防止、明示的な操作 |
| エラー表示 | デバッグしやすい |
| ホログラムプレビュー | 配置ミス防止 |
| エディタ定義 | MOD作成しやすい |
