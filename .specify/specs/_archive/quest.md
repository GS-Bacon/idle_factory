# クエストシステム

## 概要

納品プラットフォームへの納品を通じて進行するクエストシステム。
Shapez風の「目標達成→報酬→次の目標」ループ。

## クエストの種類

| 種類 | 特徴 |
|------|------|
| メインクエスト | 順次進行、スキップ不可、ストーリー進行 |
| サブクエスト | 並列進行可、任意、追加報酬 |

## メインクエスト

### 進行方式

```
クエスト1 → クエスト2 → クエスト3 → ... → 宇宙ステーション完成
```

- 1つずつ順番に進行
- スキップ不可（前のクエストを完了しないと次が出ない）
- 各クエストで新しい機械やレシピがアンロック

### 構造

| 要素 | 説明 |
|------|------|
| 目標 | 「○○を△個納品」形式 |
| 報酬 | 機械、レシピ、アイテム |
| ヒント | 達成のためのガイド（任意表示） |

### 例：序盤クエスト

| # | クエスト名 | 目標 | 報酬 |
|---|------------|------|------|
| 1 | 最初の一歩 | 鉄インゴット×5 | 採掘機×2、コンベア×20 |
| 2 | 自動化の夜明け | 鉄インゴット×100 | 精錬炉×2、採掘機×2 |
| 3 | 銅の発見 | 銅インゴット×50 | 銅鉱石バイオームマーカー |
| 4 | 金属加工 | 鉄板×50 | プレス機×1 |
| 5 | 配線の基礎 | 銅ワイヤー×100 | ワイヤー×50、石炭発電機×1 |

## サブクエスト

### 進行方式

- メインクエストと並列で進行可能
- 複数同時に受注可能
- 必須ではない（やらなくてもメイン進行可）

### 用途

| 用途 | 例 |
|------|-----|
| 追加報酬 | 「鉄板を1000個納品」→ 採掘機Tier2 |
| 探索誘導 | 「金鉱石バイオームを発見」 |
| チャレンジ | 「10分以内に銅インゴット200個」 |

## クエストUI

### HUD表示（常時）

```
┌─────────────────┐
│ 鉄インゴット    │
│ ████████░░ 80%  │
│ 80 / 100        │
└─────────────────┘
```

- 現在のメインクエスト目標
- 進捗バー
- 数値表示

### クエスト画面（Jキー）

```
┌─────────────────────────────────────────┐
│ クエスト                    [×]        │
├─────────────────────────────────────────┤
│ [メイン] [サブ] [完了]                 │
├─────────────────────────────────────────┤
│                                         │
│ ▶ 自動化の夜明け             [進行中] │
│   鉄インゴットを100個納品              │
│   進捗: 80 / 100                       │
│                                         │
│   報酬:                                │
│   ・精錬炉 ×2                          │
│   ・採掘機 ×2                          │
│                                         │
│ ─────────────────────────────────────── │
│                                         │
│ ○ 金属加工                   [未開放] │
│   前提: 自動化の夜明け                 │
│                                         │
└─────────────────────────────────────────┘
```

### ツリー表示

クエストの前提関係を可視化。

```
[最初の一歩]
     │
     ▼
[自動化の夜明け] ──→ [サブ: 大量生産]
     │
     ├──→ [金属加工]
     │         │
     │         ▼
     │    [配線の基礎]
     │         │
     ▼         ▼
[銅の発見] ──→ [電気の時代]
```

## 報酬システム

### 報酬の種類

| 種類 | 例 |
|------|-----|
| 機械 | 採掘機、精錬炉、組立機 |
| レシピ解放 | 新しいレシピが作成可能に |
| アイテム | コンベア、ワイヤー、燃料 |
| アンロック | 新エリア、新機能 |

### 報酬の受け取り

- クエスト完了時に自動でインベントリに追加
- インベントリ満杯の場合はプラットフォーム横にドロップ

## 納品プラットフォームとの連携

| 動作 | 説明 |
|------|------|
| 自動カウント | プラットフォームに流れたアイテムを自動集計 |
| 複数クエスト | 同じアイテムが複数クエストの目標なら両方にカウント |
| 超過納品 | 目標数を超えても問題なし（無駄にはならない） |

## 設計思想

| ポイント | 理由 |
|----------|------|
| スキップ不可 | 段階的に学習させるため |
| 報酬で機械を渡す | クラフトの手間を省き、すぐ自動化に集中 |
| サブは任意 | ストレスフリー、やりたい人だけ |
| 納品ベース | 「作る→流す→達成」の自動化ループ |
| **基本機能はロック禁止** | 下記参照 |

## 基本機能のロック禁止

**以下の機能はクエストでロックしない（最初から使用可能）:**

| 機能 | 理由 |
|------|------|
| コンベア分岐 | 物流の基本、ロックはストレス |
| スプリッター | 分配は必須機能 |
| フィルタリング | 仕分けは自動化の基本 |
| パイプ分岐 | 液体物流の基本 |
| 合流（ジッパー等） | 物流の基本 |

**クエストでロックするのは「より良い」もの:**

| ロック対象 | 例 |
|------------|-----|
| 上位ティア機械 | 採掘機Tier2、精錬炉Tier3 |
| 新しい加工種類 | 化学プラント、遠心分離機 |
| 高度な自動化 | ロボット、ブループリント |
| 大型機械 | マルチブロック、列車 |

**原則:** 「できること」は最初から与える。「もっと効率よくできる」を報酬に。
