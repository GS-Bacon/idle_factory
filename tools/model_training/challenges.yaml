# Model Training Challenges
# モデリングスキル改善のための課題定義

version: "1.0.0"

# ========== ツール課題 (Difficulty 1-3) ==========
challenges:
  # --- 初級: 斧 ---
  - id: tool_axe
    name: "Axe"
    category: tool
    difficulty: 2
    description: "木製ハンドルと鉄製ヘッドの片刃斧"

    constraints:
      primitives: [octagon, octagonal_prism, chamfered_cube, trapezoid]
      materials: [wood, iron]
      triangle_budget: [80, 200]
      total_height: [0.18, 0.25]

    ratios:
      handle_ratio:
        min: 0.60
        max: 0.70
        description: "ハンドル長 / 全長"
      head_width_ratio:
        min: 4.0
        max: 6.0
        description: "ヘッド幅 / ハンドル直径"
      grip_ratio:
        min: 1.10
        max: 1.20
        description: "グリップ半径 / ハンドル半径"

    required_parts:
      - name: handle
        type: octagonal_prism
        material: wood
        orientation: Z  # 主軸: 縦（下から上へ伸びる）
        position: bottom
        description: "木製ハンドル"
      - name: head
        type: chamfered_cube
        material: iron
        orientation: X  # 主軸: 横（刃の方向）
        position: top
        description: "斧ヘッド本体"
      - name: blade
        type: trapezoid
        material: iron
        orientation: X  # 主軸: 横（刃先が前方を向く）
        position: top_front
        facing: front  # 刃先の向き
        description: "斧刃（台形）"
      - name: collar
        type: octagonal_prism
        material: iron
        orientation: Z
        position: handle_top
        description: "ヘッドとハンドルの接続部"

    success_threshold: 7.5
    reference_models: [hammer, pickaxe]
    hints:
      - "刃は台形(trapezoid)で表現"
      - "ヘッドとハンドルはcollarで接続"
      - "グリップリングは3つ程度"

  # --- 初級: レンチ ---
  - id: tool_wrench
    name: "Wrench"
    category: tool
    difficulty: 2
    description: "オープンエンドレンチ"

    constraints:
      primitives: [octagon, chamfered_cube]
      materials: [iron, dark_steel]
      triangle_budget: [60, 150]
      total_height: [0.15, 0.22]

    ratios:
      handle_ratio:
        min: 0.55
        max: 0.65
        description: "ハンドル長 / 全長"
      jaw_opening_ratio:
        min: 0.15
        max: 0.25
        description: "開口幅 / ヘッド幅"

    required_parts:
      - name: handle
        type: chamfered_cube
        material: iron
        orientation: Z  # 主軸: 縦
        position: bottom
      - name: head
        type: chamfered_cube
        material: iron
        orientation: X  # 主軸: 横（開口方向）
        position: top
        description: "開口部付きヘッド"

    success_threshold: 7.0
    reference_models: [hammer]
    hints:
      - "開口部はBoolean差分で作成"
      - "ハンドルは細長いchamfered_cube"

  # --- 初級: シャベル ---
  - id: tool_shovel
    name: "Shovel"
    category: tool
    difficulty: 2
    description: "木製ハンドルと鉄製ブレードのシャベル"

    constraints:
      primitives: [octagon, octagonal_prism, chamfered_cube, trapezoid]
      materials: [wood, iron]
      triangle_budget: [80, 180]
      total_height: [0.20, 0.28]

    ratios:
      handle_ratio:
        min: 0.65
        max: 0.75
        description: "ハンドル長 / 全長"
      blade_width_ratio:
        min: 3.0
        max: 5.0
        description: "ブレード幅 / ハンドル直径"

    required_parts:
      - name: handle
        type: octagonal_prism
        material: wood
        orientation: Z  # 主軸: 縦
        position: bottom
      - name: blade
        type: chamfered_cube
        material: iron
        orientation: Y  # 主軸: 横幅（左右に広がる）
        position: top
        facing: front  # 掘る面が前方
        description: "シャベルブレード"
      - name: collar
        type: octagonal_prism
        material: iron
        orientation: Z
        position: handle_top

    success_threshold: 7.5
    reference_models: [pickaxe]

  # --- 中級: ドリル ---
  - id: tool_drill
    name: "Hand Drill"
    category: tool
    difficulty: 3
    description: "手動ドリル（ギア付き）"

    constraints:
      primitives: [octagon, octagonal_prism, chamfered_cube, hexagon]
      materials: [wood, iron, brass]
      triangle_budget: [150, 350]
      total_height: [0.18, 0.25]

    ratios:
      handle_ratio:
        min: 0.40
        max: 0.50
        description: "ハンドル部 / 全長"
      gear_ratio:
        min: 0.15
        max: 0.25
        description: "ギア直径 / 全長"

    required_parts:
      - name: handle
        type: octagonal_prism
        material: wood
        orientation: Y  # 主軸: 横（握る方向）
        position: back
      - name: gear
        type: octagon
        material: brass
        orientation: X  # 回転面がX-Z平面
        position: center
        description: "駆動ギア"
      - name: bit
        type: octagonal_prism
        material: iron
        orientation: Z  # 主軸: 縦（穴を開ける方向）
        position: bottom
        facing: down  # 先端が下向き
        description: "ドリルビット"

    success_threshold: 7.0
    hints:
      - "ギアはcreate_gear()関数を使用"
      - "ビットは先端が細くなる"

# ========== 機械課題 (Difficulty 3-5) ==========

  # --- 中級: 精錬炉 ---
  - id: machine_smelter
    name: "Smelter"
    category: machine
    difficulty: 4
    description: "高温精錬炉（2入力1出力）"

    constraints:
      primitives: [octagon, octagonal_prism, chamfered_cube, hexagon]
      materials: [iron, dark_steel, brass, copper]
      triangle_budget: [400, 900]
      size: [0.9, 0.9, 0.9]

    ratios:
      body_fill:
        min: 0.70
        max: 0.90
        description: "ボディ / ブロックサイズ"
      detail_density:
        min: 0.10
        max: 0.25
        description: "ディテール面積比"

    connection_faces:
      - facing: front
        type: pipe
        radius: 0.12
        description: "入力パイプ1"
      - facing: back
        type: pipe
        radius: 0.12
        description: "出力パイプ"
      - facing: top
        type: hopper
        radius: 0.15
        description: "上部投入口"

    required_parts:
      - name: body
        type: chamfered_cube
        material: dark_steel
      - name: opening
        type: accent_light
        material: danger
        description: "高温表示"
      - name: bolts
        type: corner_bolts
        count: 4

    success_threshold: 7.0
    reference_models: [furnace]
    hints:
      - "高温部分はdangerアクセントカラー"
      - "接続面にはフランジを追加"

  # --- 中級: ミキサー ---
  - id: machine_mixer
    name: "Mixer"
    category: machine
    difficulty: 4
    description: "回転式ミキサー"

    constraints:
      primitives: [octagon, octagonal_prism, chamfered_cube]
      materials: [iron, copper, brass]
      triangle_budget: [500, 1000]
      size: [0.9, 0.9, 0.9]

    ratios:
      body_fill:
        min: 0.65
        max: 0.85
        description: "ボディ / ブロックサイズ"
      motor_ratio:
        min: 0.15
        max: 0.25
        description: "モーター / ボディ"

    connection_faces:
      - facing: left
        type: pipe
        radius: 0.10
      - facing: right
        type: pipe
        radius: 0.10
      - facing: bottom
        type: pipe
        radius: 0.12

    required_parts:
      - name: tank
        type: octagonal_prism
        material: iron
        description: "ミキシングタンク"
      - name: motor
        type: octagonal_prism
        material: copper
      - name: shaft
        type: octagonal_prism
        material: brass

    success_threshold: 7.0
    hints:
      - "タンクは縦置きの八角柱"
      - "モーターはタンク上部に配置"

  # --- 上級: 組立機 ---
  - id: machine_assembler
    name: "Assembler"
    category: machine
    difficulty: 5
    description: "多入力組立機"

    constraints:
      primitives: [octagon, octagonal_prism, chamfered_cube, hexagon]
      materials: [iron, dark_steel, brass, copper]
      triangle_budget: [600, 1200]
      size: [0.9, 0.9, 0.9]

    ratios:
      body_fill:
        min: 0.75
        max: 0.95
        description: "ボディ / ブロックサイズ"

    connection_faces:
      - facing: left
        type: conveyor
        width: 0.3
      - facing: right
        type: conveyor
        width: 0.3
      - facing: front
        type: pipe
        radius: 0.08
      - facing: back
        type: pipe
        radius: 0.08

    required_parts:
      - name: frame
        type: chamfered_cube
        material: dark_steel
      - name: arm_base
        type: octagonal_prism
        material: iron
      - name: gears
        type: gear
        material: brass
        count: 2

    success_threshold: 6.5
    hints:
      - "複数の接続面を正確に配置"
      - "ギアは回転アニメーション用"

# ========== 難易度説明 ==========
difficulty_levels:
  1:
    name: "入門"
    description: "基本的なプリミティブのみ、単純な構造"
    max_parts: 3
  2:
    name: "初級"
    description: "複数パーツの組み合わせ、基本的な比率"
    max_parts: 5
  3:
    name: "中級"
    description: "複雑な構造、厳密な比率、接続面"
    max_parts: 8
  4:
    name: "上級"
    description: "多数のパーツ、複数の接続面、アニメーション準備"
    max_parts: 12
  5:
    name: "マスター"
    description: "全要素の統合、高度なディテール"
    max_parts: 16
