# Infinite Voxel Factory

**自動化と建築に特化した3Dボクセル工場シミュレーションゲーム + データエディタ**

> **🤖 AI開発プロジェクト**: このゲームはClaude Code (Anthropic) を使用して開発されています。

[![Rust](https://img.shields.io/badge/rust-stable-orange.svg)](https://www.rust-lang.org)
[![Bevy](https://img.shields.io/badge/bevy-0.15-blue.svg)](https://bevyengine.org)
[![License](https://img.shields.io/badge/license-MIT-green.svg)](LICENSE)

## 🎯 このゲームを作った理由

既存の工場ゲームをプレイして感じた不満を解決するために作りました。

| 既存ゲームの不満 | Infinite Voxel Factoryの解決策 |
|----------------|------------------------------|
| 序盤は工場より飯の心配ばかり | サバイバル要素は最小限。工場建設に集中できる |
| 雑魚敵が工場ラインを破壊してストレス | ボスはいるが、雑魚による工場破壊なし |
| 大規模工場での移動が遅くてしんどい | ジェットパック標準装備。3D空間を自由に飛行 |
| Mod管理が面倒 | Mod SDK内蔵、`mods/`から自動読み込み |
| コンベアの合流・分配挙動が雑 | ジッパー合流、均等分配など挙動にこだわり |
| アップグレードのたびに機械を破壊→再設置 | その場で置き換え可能 |
| 自動化に限界がある | Luaスクリプトで何でも自動化可能 |
| 2D/レイヤー制限で理想のライン構築が難しい | 3Dボクセル空間で完全自由配置 |
| ゲーム内グリッドがわかりづらい | ボクセルベースで完全グリッド。美しいライン構築が容易 |

## 👥 こんな人に向いています

- 飯や敵の心配をせず、**純粋に工場だけ作りたい**人
- コンベアの挙動（合流・分配）に**こだわりたい**人
- 機械をいちいち壊さず**スムーズにアップグレード**したい人
- **Luaで自分だけの自動化システム**を組みたい人
- **3Dボクセル空間で美しいライン**を構築したい人
- 大規模工場を**ジェットパックで飛び回りながら眺めたい**人

## 🎮 ゲーム概要

### コアコンセプト
- **自動化ファースト**: すべての機能は自動化生産チェーンの構築を支援
- **ジェットパック飛行**: 3D空間を自由に移動
- **最終目標**: 軌道上の宇宙ステーション建造

### インスピレーション元
- **Factorio** - 自動化の深さ
- **Satisfactory** - 3D工場建設の楽しさ
- **Shapez / Shapez 2** - 眺める快感、納品プラットフォーム
- **Minecraft (Create Mod)** - ボクセルの自由度、全レシピ解放の設計思想

### 実装済み機能
- 工場建設（コンベア、採掘機、組立機、加工機械）
- 電力ネットワーク（運動エネルギー伝達、過負荷検出）
- マルチブロック構造、流体/熱/振動システム
- Luaスクリプト、信号システム（論理ゲート）
- インベントリ、クエスト、天候/昼夜サイクル
- サウンドシステム（空間オーディオ、ミキシング階層）
- UIフィードバック（視覚/音声）

## 🛠️ データ駆動設計

### Factory Data Architect（エディタ）
ゲームコンテンツを視覚的に編集できるTauriベースのデスクトップアプリ。**コードを書かずにゲーム体験をカスタマイズ可能**。

| エディタ | 機能 |
|----------|------|
| **Items** | アイテム定義、i18n_key自動生成、ID重複チェック |
| **Recipes** | React Flowによるノードベース編集 |
| **Quests** | メイン/サブクエスト、前提条件、報酬設定 |
| **Multiblock** | React Three Fiberによる3Dグリッド編集 |
| **Biomes** | Canvas 2Dノイズプレビュー |
| **Sounds** | オーディオプレビュー付き設定 |

### Modシステム
```
mods/
└── my-mod/
    ├── manifest.yaml    # メタ情報、依存関係
    ├── data/            # YAML定義（アイテム、レシピ等）
    └── scripts/         # Luaスクリプト
```

- **ホットリロード対応**: 開発中にゲームを再起動せずに変更を反映
- **依存解決**: Mod間の依存関係を自動処理
- **サンドボックス実行**: Luaスクリプトを安全に実行

### リソースパック（テクスチャパック）
Minecraft風のリソースパックシステム。**一部のアセットだけを上書き・追加可能**。

```
resource_packs/
└── my-pack/
    ├── pack.yaml    # メタ情報、優先度
    ├── textures/    # UI、ブロックテクスチャ
    ├── models/      # .voxモデル
    ├── sounds/      # サウンドファイル
    ├── fonts/       # カスタムフォント
    └── lang/        # 翻訳ファイル（ja.yaml, en.yaml）
```

- **部分上書き**: 変更したいファイルだけ配置すればOK
- **優先度制御**: 複数パックを積み重ね、後から適用したものが優先
- **多言語対応**: 翻訳ファイルも部分上書き可能

## 🤖 AI駆動開発

### 開発手法
Claude Codeを活用した**仕様駆動開発 (Spec-Driven Development)** を採用。

| 要素 | 内容 |
|------|------|
| **仕様管理** | `.specify/` ディレクトリで憲章・仕様・計画を一元管理 |
| **デザインパターン** | 52パターンを策定（UI、サウンド、ネットワーク、アクセシビリティ等） |
| **品質基準** | WCAG AA準拠、60FPS目標、0.1秒以内のUI応答 |
| **セキュリティ** | AES-256-GCM暗号化によるセーブデータ保護 |

### AIとの協働ポイント
- **スキルファイル**: `.claude/skills/` にドメイン知識を蓄積、効率的なコンテキスト共有
- **圧縮ドキュメント**: トークン最適化済みの仕様書（30%削減）
- **パターンカタログ**: 類似問題への一貫したソリューション適用

## ⚙️ アーキテクチャの工夫

### ECS + データ駆動
| 設計原則 | 実装 |
|---------|------|
| **分離** | ロジック（Rust）とデータ（YAML/Lua）を完全分離 |
| **拡張性** | 新機能はデータ追加のみで実現可能 |
| **テスト容易性** | 純粋関数中心、モック不要のユニットテスト |

### 品質保証
- **100+件のテスト**: コアシステム90%+カバレッジ
- **Clippy警告ゼロ**: リンターによる静的解析
- **アクセシビリティ**: 色覚モード、UIスケール、入力モード切替

### パフォーマンス最適化
- **チャンクシステム**: 32³ブロック単位の空間分割
- **グリーディメッシング**: 描画コール削減
- **LOD**: 4段階の詳細度切替
- **非同期チャンク生成**: メインスレッドブロッキング回避

## 📋 今後の予定

- ワールドセーブ/ロード（チャンクデータ完全保存）
- チュートリアル/ヘルプシステム
- ローカライズ対応（日本語/英語）
- マルチプレイヤー（協力プレイ）

## 🛠️ 技術スタック

| 項目 | 詳細 |
|------|------|
| ゲーム | Rust + Bevy 0.15 (ECS) |
| エディタ | Tauri + React + TypeScript |
| スクリプト | Lua 5.4 (mlua) |
| 暗号化 | AES-256-GCM |

## 📄 ライセンス

MIT License

---

**Status**: Phase 5完了 | 開発中
