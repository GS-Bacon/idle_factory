# I.4: ホットキー競合テスト
name = "I.4: ホットキー競合"
description = "UIが開いている状態で他のUIキーを押した時の挙動確認"

# 初期状態確認
[[steps]]
action = "get_state"

[[steps]]
action = "assert"
params = { condition = "ui_state == Gameplay" }

# Part 1: ポーズ中にE（インベントリキー）
[[steps]]
action = "send_input"
params = { action = "Cancel" }

[[steps]]
action = "wait"
params = { ms = 100 }

[[steps]]
action = "assert"
params = { condition = "ui_state == PauseMenu" }

# Eキーを押してもポーズのまま（インベントリは開かない）
[[steps]]
action = "send_input"
params = { action = "ToggleInventory" }

[[steps]]
action = "wait"
params = { ms = 100 }

[[steps]]
action = "assert"
params = { condition = "ui_state == PauseMenu" }

# ポーズを閉じる
[[steps]]
action = "send_input"
params = { action = "Cancel" }

[[steps]]
action = "wait"
params = { ms = 100 }

[[steps]]
action = "assert"
params = { condition = "ui_state == Gameplay" }

# Part 2: インベントリ中にESC
[[steps]]
action = "send_input"
params = { action = "ToggleInventory" }

[[steps]]
action = "wait"
params = { ms = 100 }

[[steps]]
action = "assert"
params = { condition = "ui_state == Inventory" }

# ESCキーでインベントリを閉じる（Gameplayに戻る）
[[steps]]
action = "send_input"
params = { action = "Cancel" }

[[steps]]
action = "wait"
params = { ms = 100 }

# ESCでUIを閉じてGameplayに戻ることを期待
[[steps]]
action = "assert"
params = { condition = "ui_state == Gameplay" }
