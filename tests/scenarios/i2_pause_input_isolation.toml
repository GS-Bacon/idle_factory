# I.2: ポーズ中の入力隔離テスト
name = "I.2: ポーズ中の入力隔離"
description = "ポーズ中にEキーでインベントリが開かず、移動もしないことを確認"

# 初期状態を記録
[[steps]]
action = "get_state"

[[steps]]
action = "assert"
params = { condition = "ui_state == Gameplay" }

# ポーズメニューを開く（Cancel = ESC）
[[steps]]
action = "send_input"
params = { action = "Cancel" }

[[steps]]
action = "wait"
params = { ms = 100 }

[[steps]]
action = "assert"
params = { condition = "ui_state == PauseMenu" }

# Eキーでインベントリが開かないことを確認
[[steps]]
action = "send_input"
params = { action = "ToggleInventory" }

[[steps]]
action = "wait"
params = { ms = 100 }

[[steps]]
action = "assert"
params = { condition = "ui_state == PauseMenu" }

# 移動キーを送信
[[steps]]
action = "send_input"
params = { action = "MoveForward" }

[[steps]]
action = "wait"
params = { ms = 500 }

# 位置が変わっていないことを確認
[[steps]]
action = "compare_position"
params = { expect = "unchanged", tolerance = 0.1 }

# 後片付け: ポーズを閉じる
[[steps]]
action = "send_input"
params = { action = "Cancel" }

[[steps]]
action = "wait"
params = { ms = 100 }

[[steps]]
action = "assert"
params = { condition = "ui_state == Gameplay" }
