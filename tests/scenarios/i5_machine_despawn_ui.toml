# I.5: 機械削除時のUI復帰テスト
name = "I.5: 機械削除時のUI復帰"
description = "機械UIから戻った後、正常に入力が効くことを確認"

# 初期状態を確認
[[steps]]
action = "get_state"

[[steps]]
action = "assert"
params = { condition = "ui_state == Gameplay" }

# 機械UIを開く（シミュレート）
[[steps]]
action = "set_ui_state"
params = { state = "MachineUI" }

[[steps]]
action = "wait"
params = { ms = 100 }

[[steps]]
action = "assert"
params = { condition = "ui_state == MachineUI" }

# 機械UIからGameplayへ戻す（機械削除をシミュレート）
[[steps]]
action = "set_ui_state"
params = { state = "Gameplay" }

[[steps]]
action = "wait"
params = { ms = 100 }

[[steps]]
action = "assert"
params = { condition = "ui_state == Gameplay" }

# CADスタイル操作: カーソルは常に表示（ロックされない）
[[steps]]
action = "assert"
params = { condition = "cursor_locked == false" }

# 入力が正常に効くことを確認（インベントリトグル）
[[steps]]
action = "send_input"
params = { action = "ToggleInventory" }

[[steps]]
action = "wait"
params = { ms = 100 }

[[steps]]
action = "assert"
params = { condition = "ui_state == Inventory" }

# 後片付け
[[steps]]
action = "send_input"
params = { action = "ToggleInventory" }

[[steps]]
action = "wait"
params = { ms = 100 }

[[steps]]
action = "assert"
params = { condition = "ui_state == Gameplay" }
