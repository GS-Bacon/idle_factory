# 批判的ゲームレビュー 2025-12-25

## 総合評価: B

ファクトリーゲームとしての基盤は整っているが、コード品質とUX改善の余地がある。

---

## カテゴリ別評価

| カテゴリ | 評価 | 一言 |
|---------|------|------|
| UI/UX | B | 基本機能はあるが、没入感が欠ける |
| ゲームプレイ | B | システムは動作するが、フィードバック不足 |
| コード品質 | B- | panic!が本番コードに存在、debug!過多 |
| 競合比較 | C | Factorioの深さに遠く及ばない |

---

## 致命的な問題（今すぐ直すべき）

### 1. 本番コードにpanic!が存在
**場所**: `src/gameplay/machines/assembler.rs`, `src/ui/machine_ui.rs`
**詳細**: 5箇所でpanic!を使用。ゲームがクラッシュする原因になる。
**対応**: Result/Optionで適切にエラーハンドリングすべき。

```rust
// 現状 (悪い例)
panic!("Machine at assembler position is not an assembler");

// あるべき姿
return Err(AssemblerError::InvalidMachineType);
```

---

## 重大な問題（近いうちに直すべき）

### 2. 過剰なdebug!ログ
**場所**: `src/gameplay/machines/assembler.rs` (20箇所)
**詳細**: 毎tickで大量のdebugログが出力され、パフォーマンス低下の原因。
**対応**: 必要最小限に削減、または条件付きログに変更。

### 3. 手に持つアイテムが汎用キューブ
**場所**: `src/gameplay/held_item.rs:81` (TODO)
**詳細**: 全アイテムが灰色のキューブで表示される。視覚的フィードバック不足。
**対応**: VoxelAssetsから実際のモデルを読み込んで表示。

### 4. unwrap()の多用
**計測**: 48箇所
**高リスク箇所**:
- `src/gameplay/machines/assembler.rs`: 5箇所
- `src/core/profile.rs`: 5箇所
- `src/gameplay/scripting.rs`: 4箇所
**対応**: 高リスク箇所を優先的にResult/Optionに置き換え。

---

## 改善推奨（余裕があれば）

### 5. clone()の過剰使用
**計測**: 157箇所
**影響**: `src/ui/inventory_ui.rs` (29箇所)でホットパスでのcloneが多い
**対応**: 参照渡しや`Cow<T>`の検討。

### 6. E2Eテストのカバレッジ
**現状**: 11/11 pass、7/9タブ対応
**未対応**: 一部UIタブのテストが未実装
**対応**: 全タブのE2Eテスト実装。

### 7. ドキュメント不足
**不足**: `docs/GETTING_STARTED.md` が未作成
**対応**: 新規プレイヤー/開発者向けガイドの作成。

---

## 良い点（お世辞ではなく本当に良い点のみ）

- **Clippy 0警告**: コード品質の基本は守られている
- **テスト177件pass**: 堅実なテスト基盤
- **モジュール構造**: core/gameplay/rendering/ui/networkの分離が適切
- **データ駆動設計**: YAML+Luaによる柔軟な設定

---

## 競合との差別化ポイント

### vs Factorio
- **勝っている点**: 3Dボクセル表現、マルチブロック建築
- **負けている点**: 自動化の深さ、回路ネットワーク、ゲームループの完成度
- **差異**: ストレスフリー設計 vs 効率追求型

### vs Satisfactory
- **勝っている点**: MOD/スクリプト対応、軽量動作
- **負けている点**: ビジュアル品質、探索要素
- **差異**: 建築特化 vs 探索+建築

### vs Minecraft
- **勝っている点**: ファクトリー専用設計、電力システム
- **負けている点**: 自由度、コンテンツ量、コミュニティ
- **差異**: ニッチ vs 汎用

---

## 改善優先度

| # | 問題 | 優先度 | 工数 |
|---|------|--------|------|
| 1 | panic!除去 | 🔴critical | 小 |
| 2 | debug!削減 | 🟡high | 小 |
| 3 | held_item実装 | 🟡high | 中 |
| 4 | unwrap修正 | 🟠mid | 中 |
| 5 | clone最適化 | 🟢low | 大 |

---

## 次回レビューで注目すべき点

1. panic!が完全に除去されているか
2. 持ちアイテムの視覚的フィードバック
3. E2Eテストカバレッジの向上
