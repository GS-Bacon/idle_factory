# å®Ÿè£…è¨ˆç”»

> **å¯¾è±¡**: AIï¼ˆã‚¿ã‚¹ã‚¯å®Ÿè¡Œæ™‚ã®å‚ç…§ç”¨ï¼‰
> **äººé–“å‘ã‘**: `.specify/roadmap.md`ï¼ˆé€²æ—ç¢ºèªã€å…¨ä½“åƒï¼‰
> **è¨­è¨ˆè©³ç´°**: `.claude/architecture.md`

## ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆå½¹å‰²åˆ†æ‹…

| ãƒ•ã‚¡ã‚¤ãƒ« | å¯¾è±¡ | å†…å®¹ |
|----------|------|------|
| `.specify/roadmap.md` | äººé–“ | ãƒã‚¤ãƒ«ã‚¹ãƒˆãƒ¼ãƒ³æ¦‚è¦ã€å®Œäº†æ¡ä»¶ï¼ˆç°¡æ½”ï¼‰ |
| **ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«** | AI | ã‚¿ã‚¹ã‚¯è©³ç´°ã€è¨­è¨ˆã‚³ãƒ¼ãƒ‰ä¾‹ã€ã‚·ãƒŠãƒªã‚ªãƒ†ã‚¹ãƒˆä¾‹ |
| `.claude/architecture.md` | ä¸¡æ–¹ | æ©Ÿèƒ½è¨­è¨ˆéª¨æ ¼ã€æ‹¡å¼µãƒã‚¤ãƒ³ãƒˆ |

---

## ç¾çŠ¶ã‚µãƒãƒªãƒ¼ (2026-01-11)

| é …ç›® | å€¤ |
|------|-----|
| ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | **0.3.167** |
| ã‚³ãƒ¼ãƒ‰è¡Œæ•° | **29,253è¡Œ** |
| ãƒ†ã‚¹ãƒˆ | **613ä»¶** é€šé |
| Clippyè­¦å‘Š | **0ä»¶** |
| ç¾åœ¨ã®ãƒã‚¤ãƒ«ã‚¹ãƒˆãƒ¼ãƒ³ | **M2.5: UIãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ & ãƒã‚°ä¿®æ­£** |

---

## ãƒã‚¤ãƒ«ã‚¹ãƒˆãƒ¼ãƒ³ä¸€è¦§

| MS | åå‰ | çŠ¶æ…‹ | æ¦‚è¦ |
|----|------|------|------|
| M1 | åŸºç›¤æ•´å‚™ | âœ… å®Œäº† | ComponentåŒ–ã€å‹•çš„IDã€ã‚¤ãƒ™ãƒ³ãƒˆ |
| M2 | Core ModåŸºç›¤ | âœ… å®Œäº† | WASM Modå¯¾å¿œ |
| **M2.5** | **UIãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ & ãƒã‚°ä¿®æ­£** | âŒ é€²è¡Œä¸­ | UIåˆ†é›¢ç¢ºèªã€ãƒã‚°æ½°ã— |
| M3 | é›»åŠ›ã‚·ã‚¹ãƒ†ãƒ  | âŒ æœªç€æ‰‹ | ç™ºé›»æ©Ÿã€é›»ç·šã€æ¶ˆè²» |
| M4 | æ¶²ä½“ãƒ»ä¿¡å· | âŒ | ãƒ‘ã‚¤ãƒ—ã€è«–ç†å›è·¯ |
| M4.5 | ãƒ„ãƒ¼ãƒ«ãƒ»ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ« | âŒ | ãƒ¬ã‚·ãƒ”ã‚¨ãƒ‡ã‚£ã‚¿ã€è¦‹ãŸç›®å¼·åŒ– |
| M5 | ã‚²ãƒ¼ãƒ å®Œæˆ | âŒ | æ©Ÿæ¢°50ç¨®ã€ãƒãƒƒãƒ—ã€ãƒ–ãƒ«ãƒ¼ãƒ—ãƒªãƒ³ãƒˆ |
| M6 | ãƒãƒ«ãƒãƒ—ãƒ¬ã‚¤ | âŒ | P2Pã€åŒæœŸã€æ¨©é™ |

---

## M1: åŸºç›¤æ•´å‚™ âœ… å®Œäº†

<details>
<summary>å®Œäº†æ¸ˆã¿ã‚¿ã‚¹ã‚¯ï¼ˆã‚¯ãƒªãƒƒã‚¯ã§å±•é–‹ï¼‰</summary>

| ã‚¿ã‚¹ã‚¯ | ç¢ºèªæ–¹æ³• |
|--------|----------|
| LocalPlayer EntityåŒ– | 47ç®‡æ‰€ã§ä½¿ç”¨ |
| PlayerInventory ComponentåŒ– | `Res<PlayerInventory>` 0ä»¶ |
| MachineBundleä½¿ç”¨ | 23ç®‡æ‰€ã§ä½¿ç”¨ |
| NetworkIdå®šç¾© | `components/network.rs` |
| GuardedEventWriterä½¿ç”¨ | 16ç®‡æ‰€ã§ä½¿ç”¨ |
| WebSocket API (port 9877) | 18ãƒ¡ã‚½ãƒƒãƒ‰å®Ÿè£…æ¸ˆã¿ |
| InteractingMachineçµ±åˆ | æ—§Interacting* 0ä»¶ |
| ãƒ¬ã‚¬ã‚·ãƒ¼æ©Ÿæ¢°å‰Šé™¤ | æ—§struct 0ä»¶ |
| ãƒ‘ãƒ‹ãƒƒã‚¯é˜²æ­¢ (P.0-P.4) | ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯å®Ÿè£…æ¸ˆã¿ |
| ã‚»ãƒ¼ãƒ–V2å½¢å¼ | æ–‡å­—åˆ—IDåŒ–å®Œäº† |
| å›ºå®šTickå°å…¥ | FixedUpdate(20Hz) |
| å„Pluginãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«åŒ– | D.6-D.14å…¨ã¦ç™»éŒ²æ¸ˆã¿ |
| Data Mod (TOMLèª­ã¿è¾¼ã¿) | èµ·å‹•æ™‚ãƒ­ãƒ¼ãƒ‰å®Ÿè£…æ¸ˆã¿ |
| BlockTypeâ†’ItemIdç§»è¡Œ | BlockType 0ç®‡æ‰€ã€ItemId 469ç®‡æ‰€ |

</details>

---

## M2: Core ModåŸºç›¤ âœ… å®Œäº† (2026-01-09)

**ç›®æ¨™**: WASMã§æ–°ã—ã„ã‚²ãƒ¼ãƒ ãƒ­ã‚¸ãƒƒã‚¯ã‚’è¿½åŠ ã§ãã‚‹

<details>
<summary>å®Œäº†æ¸ˆã¿ã‚¿ã‚¹ã‚¯ï¼ˆã‚¯ãƒªãƒƒã‚¯ã§å±•é–‹ï¼‰</summary>

| ã‚»ã‚¯ã‚·ãƒ§ãƒ³ | å†…å®¹ | çŠ¶æ…‹ |
|-----------|------|------|
| W.1 | Wasmtimeçµ±åˆ | âœ… |
| W.2 | Mod APIè¨­è¨ˆï¼ˆãƒ›ã‚¹ãƒˆé–¢æ•°ï¼‰ | âœ… |
| W.3 | ã‚µãƒ³ãƒ—ãƒ«Core Modä½œæˆ | âœ… |
| W.4 | Modé–“ä¾å­˜è§£æ±º | âœ… |
| W.5 | ãƒ›ãƒƒãƒˆãƒªãƒ­ãƒ¼ãƒ‰ï¼ˆé–‹ç™ºç”¨ï¼‰ | âœ… |
| W.6 | ã‚¿ã‚°ã‚·ã‚¹ãƒ†ãƒ  | âœ… |
| W.7 | ç‰¹æ®Šæ©Ÿæ¢°Core ModåŒ– | âœ… |

**å®Ÿè£…ãƒ•ã‚¡ã‚¤ãƒ«**: `src/modding/wasm/` - 8ãƒ•ã‚¡ã‚¤ãƒ«

</details>

---

## M2.5: UIãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ & ãƒã‚°ä¿®æ­£

**ç›®æ¨™**: UIãƒ»ãƒ†ã‚¯ã‚¹ãƒãƒ£é–¢é€£ã®ãƒã‚°ã‚’å¾¹åº•çš„ã«æ½°ã—ã¦ã‹ã‚‰M3ã¸é€²ã‚€

### å„ªå…ˆåº¦é †åº

| å„ªå…ˆåº¦ | ã‚»ã‚¯ã‚·ãƒ§ãƒ³ | å†…å®¹ | ä¾å­˜ | M3å‰ã«å¿…é ˆ |
|--------|-----------|------|------|-----------|
| ğŸ”´ é«˜ | **Q** | ãƒ†ã‚¹ãƒˆAPIæ‹¡å¼µ | ãªã— | âœ… å¿…é ˆ |
| ğŸ”´ é«˜ | **I** | å…¥åŠ›éš”é›¢ãƒ†ã‚¹ãƒˆ | Q | âœ… å¿…é ˆ |
| ğŸ”´ é«˜ | **B** | ãƒã‚°ä¿®æ­£ï¼ˆUIè¡¨ç¤ºç³»5ä»¶ï¼‰ | ãªã— | âœ… å¿…é ˆ |
| ğŸŸ¡ ä¸­ | T | UIè¦ç´ æ¤œè¨¼ãƒ†ã‚¹ãƒˆ | Q | æ¨å¥¨ |
| ğŸŸ¢ ä½ | U | UIãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ¢ãƒ¼ãƒ‰ | ãªã— | ä»»æ„ |
| ğŸŸ¢ ä½ | R | ãƒ–ãƒ­ãƒƒã‚¯ãƒ†ã‚¯ã‚¹ãƒãƒ£ | ãªã— | ä»»æ„ |

> **æ³¨**: Iï¼ˆå…¥åŠ›éš”é›¢ãƒ†ã‚¹ãƒˆï¼‰ã¯Qï¼ˆãƒ†ã‚¹ãƒˆAPIæ‹¡å¼µï¼‰ã®æ©Ÿèƒ½ã«ä¾å­˜ã™ã‚‹ãŸã‚ã€Qã‚’å…ˆã«å®Ÿæ–½ã™ã‚‹ã“ã¨ã€‚

### U: UIãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ¢ãƒ¼ãƒ‰

**èƒŒæ™¯**: ãƒ†ã‚¯ã‚¹ãƒãƒ£ãƒã‚°èª¿æŸ»ä¸­ã«æ²¼ã£ãŸã€‚UIã¨ã‚²ãƒ¼ãƒ ãƒ­ã‚¸ãƒƒã‚¯ã‚’åˆ†é›¢ã—ã¦ç¢ºèªã—ãŸã„ã€‚

| ã‚¿ã‚¹ã‚¯ | å†…å®¹ | çŠ¶æ…‹ |
|--------|------|------|
| U.1 | `src/bin/ui_preview.rs` ä½œæˆ | âŒ |
| U.2 | æœ€å°é™ã®ãƒ—ãƒ©ã‚°ã‚¤ãƒ³æ§‹æˆï¼ˆUIç³»ã®ã¿ï¼‰ | âŒ |
| U.3 | ãƒ€ãƒŸãƒ¼ã‚¤ãƒ³ãƒ™ãƒ³ãƒˆãƒªãƒ»ãƒ€ãƒŸãƒ¼æ©Ÿæ¢°ãƒ‡ãƒ¼ã‚¿ | âŒ |
| U.4 | ã‚­ãƒ¼æ“ä½œï¼ˆE=ã‚¤ãƒ³ãƒ™ãƒ³ãƒˆãƒªã€Esc=ãƒãƒ¼ã‚ºç­‰ï¼‰ | âŒ |
| U.5 | èƒŒæ™¯ã¯å˜è‰²ã¾ãŸã¯åºŠã®ã¿ | âŒ |

**èµ·å‹•æ–¹æ³•**:
```bash
cargo run --bin ui_preview
```

**å«ã‚ã‚‹ã‚‚ã®**:
- UIPluginï¼ˆã‚¤ãƒ³ãƒ™ãƒ³ãƒˆãƒªã€ãƒãƒ¼ã‚ºãƒ¡ãƒ‹ãƒ¥ãƒ¼ã€ã‚¯ã‚¨ã‚¹ãƒˆUIç­‰ï¼‰
- InputManagerPluginï¼ˆã‚­ãƒ¼å…¥åŠ›ï¼‰
- ãƒ€ãƒŸãƒ¼ã®PlayerInventoryã€CurrentQuestç­‰

**å«ã‚ãªã„ã‚‚ã®**:
- WorldDataã€ChunkMeshTasksï¼ˆãƒ¯ãƒ¼ãƒ«ãƒ‰ç”Ÿæˆï¼‰
- MachineSystemsPluginï¼ˆæ©Ÿæ¢°å‡¦ç†ï¼‰
- player_moveã€block_breakç­‰ï¼ˆã‚²ãƒ¼ãƒ ãƒ—ãƒ¬ã‚¤ï¼‰

### T: UIè¦ç´ æ¤œè¨¼ãƒ†ã‚¹ãƒˆï¼ˆå‹•çš„IDãƒ‘ã‚¿ãƒ¼ãƒ³ï¼‰

**èƒŒæ™¯**: ç¾åœ¨ã®ã‚·ãƒŠãƒªã‚ªãƒ†ã‚¹ãƒˆã¯`ui_state`ã—ã‹æ¤œè¨¼ã§ããªã„ã€‚ã©ã®UIè¦ç´ ãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹ã‹ã‚’è‡ªå‹•ãƒ†ã‚¹ãƒˆã—ãŸã„ã€‚

**è¨­è¨ˆæ–¹é‡**: æ—¢å­˜ã®`Id<T>`ãƒ‘ã‚¿ãƒ¼ãƒ³ã«å¾“ã„ã€Modæ‹¡å¼µå¯èƒ½ãªå‹•çš„IDã§å®Ÿè£…

| ã‚¿ã‚¹ã‚¯ | å†…å®¹ | çŠ¶æ…‹ |
|--------|------|------|
| T.1 | `UIElementId = Id<UIElementCategory>` å®šç¾© | âŒ |
| T.2 | `UIElementSpec` + ãƒ¬ã‚¸ã‚¹ãƒˆãƒªä½œæˆ | âŒ |
| T.3 | `mods/base/ui_elements.toml` ã§ä»•æ§˜å®šç¾© | âŒ |
| T.4 | `update_ui_visibility` ã‚·ã‚¹ãƒ†ãƒ å®Ÿè£… | âŒ |
| T.5 | `test.get_state`ã«`visible_elements`è¿½åŠ  | âŒ |
| T.6 | ã‚·ãƒŠãƒªã‚ªãƒ†ã‚¹ãƒˆã§æ¤œè¨¼ | âŒ |

**ãƒ‡ãƒ¼ã‚¿æ§‹é€ **:
```rust
// å‹•çš„UIè¦ç´ IDï¼ˆModã§è¿½åŠ å¯èƒ½ï¼‰
pub type UIElementId = Id<UIElementCategory>;

// ä»•æ§˜å®šç¾©
pub struct UIElementSpec {
    pub id: String,           // "base:hotbar", "mymod:custom_hud"
    pub name: String,
    pub show_in: Vec<String>, // ["Gameplay", "Inventory"]
}
```

**TOMLå®šç¾©ï¼ˆSingle Source of Truthï¼‰**:
```toml
# mods/base/ui_elements.toml
[[ui_elements]]
id = "base:hotbar"
name = "ãƒ›ãƒƒãƒˆãƒãƒ¼"
show_in = ["Gameplay", "Inventory", "Machine"]

[[ui_elements]]
id = "base:inventory_panel"
name = "ã‚¤ãƒ³ãƒ™ãƒ³ãƒˆãƒªãƒ‘ãƒãƒ«"
show_in = ["Inventory"]

[[ui_elements]]
id = "base:pause_menu"
name = "ãƒãƒ¼ã‚ºãƒ¡ãƒ‹ãƒ¥ãƒ¼"
show_in = ["PauseMenu"]

[[ui_elements]]
id = "base:crosshair"
name = "ç…§æº–"
show_in = ["Gameplay"]

[[ui_elements]]
id = "base:quest_tracker"
name = "ã‚¯ã‚¨ã‚¹ãƒˆãƒˆãƒ©ãƒƒã‚«ãƒ¼"
show_in = ["Gameplay"]
```

**ã‚·ã‚¹ãƒ†ãƒ **:
```rust
fn update_ui_visibility(
    ui_state: Res<UIState>,
    registry: Res<UIElementRegistry>,
    mut query: Query<(&UIElementId, &mut Visibility)>,
) {
    let current = ui_state.current().to_string();
    for (element_id, mut vis) in &mut query {
        let spec = registry.get(element_id);
        *vis = if spec.show_in.contains(&current) {
            Visibility::Inherited
        } else {
            Visibility::Hidden
        };
    }
}
```

**ãƒ¡ãƒªãƒƒãƒˆ**:
- Modã§æ–°UIã‚’è¿½åŠ å¯èƒ½ï¼ˆ`mymod:custom_hud`ç­‰ï¼‰
- è¡¨ç¤ºæ¡ä»¶ã‚‚TOMLã§å¤‰æ›´å¯èƒ½
- æ—¢å­˜ã®`Id<T>`ãƒ‘ã‚¿ãƒ¼ãƒ³ã¨ä¸€è²«æ€§
- ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«æ™‚ã«typoæ¤œå‡ºï¼ˆãƒ¬ã‚¸ã‚¹ãƒˆãƒªçµŒç”±ï¼‰

### Q: ãƒ†ã‚¹ãƒˆAPIæ‹¡å¼µï¼ˆä¿®æ­£ãƒ«ãƒ¼ãƒ—é˜²æ­¢ï¼‰

**èƒŒæ™¯**: UIãƒã‚°ä¿®æ­£ã§ã€Œç›´ã‚Šã¾ã—ãŸã€â†’ã€Œç›´ã£ã¦ãªã„ã€ã®ãƒ«ãƒ¼ãƒ—ã«é™¥ã£ãŸã€‚æ ¹æœ¬åŸå› ã¯**è¨¼æ‹ ãªã—ã§å®Œäº†å®£è¨€**ã—ã¦ã„ãŸã“ã¨ã€‚

**ç›®æ¨™**: APIã§UIè¦ç´ ã®çŠ¶æ…‹ã‚’å–å¾—ã—ã€ã‚·ãƒŠãƒªã‚ªãƒ†ã‚¹ãƒˆã§æ¤œè¨¼å¯èƒ½ã«ã™ã‚‹

| ã‚¿ã‚¹ã‚¯ | å†…å®¹ | çŠ¶æ…‹ |
|--------|------|------|
| Q.1 | `test.get_ui_elements` ãƒ¡ã‚½ãƒƒãƒ‰è¿½åŠ  | âŒ |
| Q.2 | å„UIè¦ç´ ã«`UiElementTag`ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆè¿½åŠ  | âŒ |
| Q.3 | è¡¨ç¤º/éè¡¨ç¤ºãƒ»ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒˆå¯èƒ½çŠ¶æ…‹ã‚’å–å¾— | âŒ |
| Q.4 | ã‚·ãƒŠãƒªã‚ªãƒ†ã‚¹ãƒˆã§æ¤œè¨¼å¯èƒ½ã« | âŒ |
| Q.5 | UIé·ç§»ãƒ‘ã‚¿ãƒ¼ãƒ³è‡ªå‹•æŠ½å‡ºã‚¹ã‚¯ãƒªãƒ—ãƒˆ | âŒ |

**APIè¨­è¨ˆ**:
```json
// test.get_ui_elements ãƒ¬ã‚¹ãƒãƒ³ã‚¹
{
  "elements": [
    {
      "id": "pause_title",
      "type": "text",
      "visible": true,
      "interactable": false
    },
    {
      "id": "resume_btn",
      "type": "button",
      "visible": true,
      "interactable": true
    },
    {
      "id": "settings_btn",
      "type": "button",
      "visible": true,
      "interactable": true
    },
    {
      "id": "quit_btn",
      "type": "button",
      "visible": true,
      "interactable": true
    }
  ],
  "ui_state": "PauseMenu"
}
```

**ã‚·ãƒŠãƒªã‚ªãƒ†ã‚¹ãƒˆä¾‹**:
```toml
# tests/scenarios/pause_menu_isolation.toml
name = "ãƒãƒ¼ã‚ºãƒ¡ãƒ‹ãƒ¥ãƒ¼ã®åˆ†é›¢ãƒ†ã‚¹ãƒˆ"
description = "ãƒãƒ¼ã‚ºãƒ¡ãƒ‹ãƒ¥ãƒ¼ä¸­ã¯æŒ‡å®šãƒœã‚¿ãƒ³ã®ã¿æ“ä½œå¯èƒ½"

[[steps]]
action = "send_input"
params = { action = "TogglePause" }

[[steps]]
action = "wait"
params = { ms = 100 }

[[steps]]
action = "assert"
params = { condition = "ui_state == PauseMenu" }

[[steps]]
action = "assert_ui"
params = {
  visible = ["pause_title", "resume_btn", "settings_btn", "quit_btn"],
  interactable = ["resume_btn", "settings_btn", "quit_btn"]
}

[[steps]]
# ãƒãƒ¼ã‚ºä¸­ã«ã‚¤ãƒ³ãƒ™ãƒ³ãƒˆãƒªã‚­ãƒ¼ã‚’æŠ¼ã—ã¦ã‚‚é–‹ã‹ãªã„
action = "send_input"
params = { action = "ToggleInventory" }

[[steps]]
action = "assert"
params = { condition = "ui_state == PauseMenu" }
```

**UIé·ç§»ãƒ‘ã‚¿ãƒ¼ãƒ³è‡ªå‹•æŠ½å‡º**:
```bash
# ã‚³ãƒ¼ãƒ‰ã‹ã‚‰UIé·ç§»ã‚’æŠ½å‡ºã—ã¦ã‚·ãƒŠãƒªã‚ªã‚’è‡ªå‹•ç”Ÿæˆ
./scripts/generate-ui-tests.sh

# å‡ºåŠ›ä¾‹:
# tests/scenarios/generated/
#   ui_gameplay_to_inventory.toml
#   ui_gameplay_to_pause.toml
#   ui_pause_to_settings.toml
#   ui_pause_isolation.toml  # ä»–ã®ã‚­ãƒ¼ãŒåŠ¹ã‹ãªã„ã“ã¨ã‚’ç¢ºèª
```

### I: å…¥åŠ›éš”é›¢ãƒ†ã‚¹ãƒˆï¼ˆğŸ”´ é«˜å„ªå…ˆåº¦ - M3å‰ã«å¿…é ˆï¼‰

**èƒŒæ™¯**: UIè¡¨ç¤ºä¸­ã«ã‚²ãƒ¼ãƒ æ“ä½œãŒåŠ¹ã„ã¦ã—ã¾ã†å¯èƒ½æ€§ãŒã‚ã‚‹ã€‚M3ã§é›»åŠ›UIã‚’è¿½åŠ ã™ã‚‹å‰ã«ã€æ—¢å­˜UIã®å…¥åŠ›éš”é›¢ã‚’ç¢ºå®Ÿã«ã™ã‚‹ã€‚

| ã‚¿ã‚¹ã‚¯ | å†…å®¹ | çŠ¶æ…‹ |
|--------|------|------|
| I.1 | `ui_input_isolation.toml` - ã‚¤ãƒ³ãƒ™ãƒ³ãƒˆãƒªä¸­ã«ç§»å‹•ã‚­ãƒ¼ç„¡åŠ¹ç¢ºèª | âŒ |
| I.2 | `pause_input_isolation.toml` - ãƒãƒ¼ã‚ºä¸­ã«Eã‚­ãƒ¼ãƒ»ç§»å‹•ã‚­ãƒ¼ç„¡åŠ¹ç¢ºèª | âŒ |
| I.3 | `machine_ui_isolation.toml` - æ©Ÿæ¢°UIä¸­ã®ã‚­ãƒ¼åˆ¶å¾¡ç¢ºèª | âŒ |
| I.4 | `hotkey_conflict.toml` - E+Tab, E+ESCåŒæ™‚æŠ¼ã—ãƒ†ã‚¹ãƒˆ | âŒ |
| I.5 | `machine_despawn_ui.toml` - æ©Ÿæ¢°å‰Šé™¤æ™‚ã®UIå¾©å¸°ç¢ºèª | âŒ |

**ã‚·ãƒŠãƒªã‚ªãƒ†ã‚¹ãƒˆä¾‹ï¼ˆI.1ï¼‰**:
```toml
# tests/scenarios/ui_input_isolation.toml
name = "UIå…¥åŠ›éš”é›¢: ã‚¤ãƒ³ãƒ™ãƒ³ãƒˆãƒªä¸­ã«ç§»å‹•ã‚­ãƒ¼ç„¡åŠ¹"
description = "ã‚¤ãƒ³ãƒ™ãƒ³ãƒˆãƒªã‚’é–‹ã„ã¦ã„ã‚‹é–“ã€WASDã§ç§»å‹•ã—ãªã„ã“ã¨ã‚’ç¢ºèª"

[[steps]]
action = "get_state"  # åˆæœŸä½ç½®ã‚’è¨˜éŒ²

[[steps]]
action = "send_input"
params = { action = "ToggleInventory" }

[[steps]]
action = "wait"
params = { ms = 100 }

[[steps]]
action = "assert"
params = { condition = "ui_state == Inventory" }

[[steps]]
action = "send_input"
params = { action = "MoveForward" }

[[steps]]
action = "wait"
params = { ms = 500 }

[[steps]]
action = "assert"
params = { condition = "player_position == initial_position" }  # ç§»å‹•ã—ã¦ã„ãªã„
```

**ã‚·ãƒŠãƒªã‚ªãƒ†ã‚¹ãƒˆä¾‹ï¼ˆI.4ï¼‰**:
```toml
# tests/scenarios/hotkey_conflict.toml
name = "ãƒ›ãƒƒãƒˆã‚­ãƒ¼ç«¶åˆ: E+ESCåŒæ™‚æŠ¼ã—"
description = "ESCã‚’æŠ¼ã—ãªãŒã‚‰Eã‚’æŠ¼ã—ã¦ã‚‚ã‚¤ãƒ³ãƒ™ãƒ³ãƒˆãƒªãŒé–‹ã‹ãªã„"

[[steps]]
action = "send_input"
params = { action = "TogglePause" }

[[steps]]
action = "wait"
params = { ms = 100 }

[[steps]]
action = "assert"
params = { condition = "ui_state == PauseMenu" }

[[steps]]
action = "send_input"
params = { action = "ToggleInventory" }

[[steps]]
action = "wait"
params = { ms = 100 }

[[steps]]
action = "assert"
params = { condition = "ui_state == PauseMenu" }  # ã‚¤ãƒ³ãƒ™ãƒ³ãƒˆãƒªã¯é–‹ã‹ãªã„
```

**å®Œäº†æ¡ä»¶**:
- [ ] å…¨5ä»¶ã®ã‚·ãƒŠãƒªã‚ªãƒ†ã‚¹ãƒˆãŒãƒ‘ã‚¹
- [ ] `node scripts/run-scenario.js tests/scenarios/ui_input_isolation.toml` æˆåŠŸ
- [ ] `node scripts/run-scenario.js tests/scenarios/hotkey_conflict.toml` æˆåŠŸ

### B: ãƒã‚°ä¿®æ­£

| ã‚¿ã‚¹ã‚¯ | å†…å®¹ | çŠ¶æ…‹ |
|--------|------|------|
| B.1 | UIãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã§å•é¡Œã‚’æ´—ã„å‡ºã— | âŒ |
| B.2 | ãƒ†ã‚¯ã‚¹ãƒãƒ£è¡¨ç¤ºãƒã‚°ä¿®æ­£ | âŒ |
| B.3 | UIé…ç½®ãƒ»ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆãƒã‚°ä¿®æ­£ | âŒ |

### R: ãƒ–ãƒ­ãƒƒã‚¯ãƒ†ã‚¯ã‚¹ãƒãƒ£

**èƒŒæ™¯**: ãƒ¯ãƒ¼ãƒ«ãƒ‰ã®ãƒ–ãƒ­ãƒƒã‚¯ã¯é ‚ç‚¹ã‚«ãƒ©ãƒ¼ã®ã¿ã§æç”»ã•ã‚Œã¦ã„ã‚‹ã€‚ãƒ†ã‚¯ã‚¹ãƒãƒ£ã‚’è²¼ã‚ŠãŸã„ã€‚

**ç¾çŠ¶**:
- ãƒ–ãƒ­ãƒƒã‚¯: `ItemDescriptor.color` â†’ é ‚ç‚¹ã‚«ãƒ©ãƒ¼ï¼ˆãƒ†ã‚¯ã‚¹ãƒãƒ£ãªã—ï¼‰
- `BlockTextureAtlas`ã¯å®šç¾©æ¸ˆã¿ã ãŒæœªä½¿ç”¨

**ç›®æ¨™**: ãƒ–ãƒ­ãƒƒã‚¯ã«ãƒ†ã‚¯ã‚¹ãƒãƒ£ãŒè¡¨ç¤ºã•ã‚Œã‚‹

| ã‚¿ã‚¹ã‚¯ | å†…å®¹ | çŠ¶æ…‹ |
|--------|------|------|
| R.1 | ãƒ†ã‚¯ã‚¹ãƒãƒ£ã‚¢ãƒˆãƒ©ã‚¹ä½œæˆï¼ˆ16x16 Ã— Nç¨®é¡ï¼‰ | âŒ |
| R.2 | `items.toml`ã«ã‚¢ãƒˆãƒ©ã‚¹åº§æ¨™ã‚’è¿½åŠ  | âŒ |
| R.3 | ãƒ¡ãƒƒã‚·ãƒ¥ç”Ÿæˆã«UVåº§æ¨™ã‚’è¿½åŠ  | âŒ |
| R.4 | ãƒãƒ£ãƒ³ã‚¯ãƒãƒ†ãƒªã‚¢ãƒ«ã«ã‚¢ãƒˆãƒ©ã‚¹ãƒ†ã‚¯ã‚¹ãƒãƒ£é©ç”¨ | âŒ |
| R.5 | ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ï¼ˆãƒ†ã‚¯ã‚¹ãƒãƒ£ãªã—â†’é ‚ç‚¹ã‚«ãƒ©ãƒ¼ï¼‰ | âŒ |

**items.tomlæ‹¡å¼µæ¡ˆ**:
```toml
[iron_ore]
name = "é‰„é‰±çŸ³"
color = "#8B7355"           # ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ç”¨
atlas_index = 3             # ã‚¢ãƒˆãƒ©ã‚¹å†…ã®ä½ç½®ï¼ˆ0å§‹ã¾ã‚Šï¼‰
```

**ã‚¢ãƒˆãƒ©ã‚¹æ§‹æˆ**:
```
assets/textures/block_atlas.png (256x256, 16x16ãŒ16ç¨®é¡)
â”Œâ”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”
â”‚0 â”‚1 â”‚2 â”‚3 â”‚  â† stone, dirt, grass_top, iron_ore...
â”œâ”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¤
â”‚4 â”‚5 â”‚6 â”‚7 â”‚
...
```

**ä¸¦åˆ—é–‹ç™º**: U/Tã¨ä¸¦åˆ—å®Ÿè£…å¯èƒ½ï¼ˆUIä¾å­˜ãªã—ï¼‰

**å°†æ¥æ‹¡å¼µï¼ˆå¾Œä»˜ã‘å¯èƒ½ï¼‰**: ãƒªã‚½ãƒ¼ã‚¹ãƒ‘ãƒƒã‚¯åˆ‡ã‚Šæ›¿ãˆã€è¤‡æ•°ã‚¢ãƒˆãƒ©ã‚¹å¯¾å¿œ

---

## M2â†’M3ã®é–“: ãƒªã‚½ãƒ¼ã‚¹ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯è¨­è¨ˆ

**âš ï¸ ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¨ç›¸è«‡ã—ãªãŒã‚‰é€²ã‚ã‚‹ã“ã¨**

**ç›®æ¨™**: é›»åŠ›ãƒ»æ¶²ä½“ãƒ»ä¿¡å·ã‚’çµ±ä¸€çš„ã«æ‰±ãˆã‚‹æ±ç”¨åŸºç›¤

| ã‚¿ã‚¹ã‚¯ | å†…å®¹ | çŠ¶æ…‹ |
|--------|------|------|
| N.1 | ãƒªã‚½ãƒ¼ã‚¹ç¨®åˆ¥ã®æŠ½è±¡å®šç¾© | âŒ |
| N.2 | ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æ¥ç¶šã®ä»•çµ„ã¿ | âŒ |
| N.3 | ãƒãƒ¼ãƒ‰ç¨®åˆ¥ï¼ˆProducer/Consumer/Storage/Conduitï¼‰ | âŒ |
| N.4 | è¨ˆç®—æ–¹å¼ï¼ˆä¾›çµ¦/éœ€è¦/å„ªå…ˆåº¦ï¼‰ | âŒ |
| N.5 | Modæ‹¡å¼µãƒã‚¤ãƒ³ãƒˆ | âŒ |

**è¨­è¨ˆæ¡ˆ**:
```rust
struct ResourceType {
    name: String,
    unit: String,
    decay: bool,
    max_transfer: f32,
    // M4ã§è¿½åŠ : is_signal, propagation_delay
}
```

| ç‰¹æ€§ | é›»åŠ›ãƒ»æ¶²ä½“ | ä¿¡å· |
|------|-----------|------|
| å€¤ã®å‹ | æ•°å€¤ | ON/OFF or 0-15 |
| åˆ†å²æ™‚ | åˆ†å‰²ã•ã‚Œã‚‹ | ã‚³ãƒ”ãƒ¼ã•ã‚Œã‚‹ |
| æ¶ˆè²» | ä½¿ã†ã¨æ¸›ã‚‹ | æ¸›ã‚‰ãªã„ |

---

## M3: é›»åŠ›ã‚·ã‚¹ãƒ†ãƒ 

| ã‚¿ã‚¹ã‚¯ | å†…å®¹ |
|--------|------|
| P.1 | é›»åŠ›ã‚°ãƒªãƒƒãƒ‰è¨ˆç®— |
| P.2 | ç™ºé›»æ©Ÿï¼ˆæ°´è»Šã€çŸ³ç‚­ç™ºé›»ï¼‰ |
| P.3 | é›»ç·šãƒ–ãƒ­ãƒƒã‚¯ |
| P.4 | é›»åŠ›æ¶ˆè²»æ©Ÿæ¢° |
| P.5 | é›»åŠ›UI |

---

## M4: æ¶²ä½“ãƒ»ä¿¡å·

| ã‚¿ã‚¹ã‚¯ | å†…å®¹ |
|--------|------|
| F.1 | æ¶²ä½“ã‚¹ãƒ­ãƒƒãƒˆãƒ»ãƒ‘ã‚¤ãƒ— |
| F.2 | ãƒãƒ³ãƒ—ãƒ»ã‚¿ãƒ³ã‚¯ |
| S.1 | ä¿¡å·ãƒ¯ã‚¤ãƒ¤ãƒ¼ |
| S.2 | ã‚»ãƒ³ã‚µãƒ¼ |
| S.3 | è«–ç†ã‚²ãƒ¼ãƒˆ |

---

## M4.5: èª¿æ•´ãƒ„ãƒ¼ãƒ« & ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«å¼·åŒ–

### E: ãƒ¬ã‚·ãƒ”ã‚¨ãƒ‡ã‚£ã‚¿ï¼ˆWebUIï¼‰

**ç›®æ¨™**: éã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãŒãƒ–ãƒ©ã‚¦ã‚¶ã‹ã‚‰ãƒ¬ã‚·ãƒ”èª¿æ•´ã§ãã‚‹

| ã‚¿ã‚¹ã‚¯ | å†…å®¹ | çŠ¶æ…‹ |
|--------|------|------|
| E.1 | WebSocket APIã«TOMLèª­ã¿æ›¸ãè¿½åŠ  | âŒ |
| E.2 | ç°¡æ˜“HTML+JSã‚¨ãƒ‡ã‚£ã‚¿UI | âŒ |
| E.3 | ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆä¸æ­£ãƒ¬ã‚·ãƒ”æ¤œå‡ºï¼‰ | âŒ |
| E.4 | ã‚²ãƒ¼ãƒ å†èµ·å‹•ãªã—ãƒªãƒ­ãƒ¼ãƒ‰ï¼ˆstretchï¼‰ | âŒ |

### V: ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«å¼·åŒ–

**ç›®æ¨™**: è¦‹ãŸç›®ã®ã‚¤ãƒ³ãƒ‘ã‚¯ãƒˆå‘ä¸Š

| ã‚¿ã‚¹ã‚¯ | å†…å®¹ | çŠ¶æ…‹ |
|--------|------|------|
| V.1 | ãƒ©ã‚¤ãƒ†ã‚£ãƒ³ã‚°æ”¹å–„ | âŒ |
| V.2 | ãƒã‚¹ãƒˆãƒ—ãƒ­ã‚»ã‚¹ï¼ˆãƒ–ãƒ«ãƒ¼ãƒ ç­‰ï¼‰ | âŒ |
| V.3 | æ©Ÿæ¢°ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ | âŒ |
| V.4 | ãƒ‘ãƒ¼ãƒ†ã‚£ã‚¯ãƒ« | âŒ |
| V.5 | ã‚µã‚¦ãƒ³ãƒ‰ | âŒ |

---

## M5: ã‚²ãƒ¼ãƒ å®Œæˆ

- æ©Ÿæ¢°50ç¨®é¡ä»¥ä¸Š
- ãƒ¬ã‚·ãƒ”100ç¨®é¡ä»¥ä¸Š
- ãƒãƒƒãƒ—æ©Ÿèƒ½
- ãƒ–ãƒ«ãƒ¼ãƒ—ãƒªãƒ³ãƒˆ

---

## M6: ãƒãƒ«ãƒãƒ—ãƒ¬ã‚¤

- P2Pæ¥ç¶š
- çŠ¶æ…‹åŒæœŸ
- æ¨©é™ç®¡ç†

---

## ä»˜éŒ²

### æ–°ã‚³ãƒ³ãƒ†ãƒ³ãƒ„è¿½åŠ ãƒ•ãƒ­ãƒ¼

**ç¾åœ¨ï¼ˆData Modï¼‰**:
```
1. mods/base/items.toml ã«è¿½åŠ ï¼ˆ3è¡Œï¼‰
2. mods/base/machines.toml ã«è¿½åŠ ï¼ˆ10è¡Œï¼‰
3. mods/base/recipes.toml ã«è¿½åŠ ï¼ˆ3è¡Œï¼‰
4. assets/models/ ã«3Dãƒ¢ãƒ‡ãƒ«é…ç½®
5. å®Œäº†ï¼ˆRustã‚³ãƒ¼ãƒ‰å¤‰æ›´ãªã—ï¼‰
```

**M2å®Œäº†å¾Œï¼ˆCore Modï¼‰**:
```
1. mods/my_mod/Cargo.toml ä½œæˆ
2. mods/my_mod/src/lib.rs ã«æ–°ãƒ­ã‚¸ãƒƒã‚¯
3. cargo build --target wasm32-unknown-unknown
4. mods/my_mod/mod.toml ã§ä¾å­˜å®£è¨€
5. å®Œäº†ï¼ˆæœ¬ä½“ã‚³ãƒ¼ãƒ‰å¤‰æ›´ãªã—ï¼‰
```

### M2å®Œäº†æ™‚: è¿½åŠ ã‚¿ã‚¹ã‚¯

**API Wikiè‡ªå‹•ç”Ÿæˆ**:
- ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚³ãƒ¡ãƒ³ãƒˆã‹ã‚‰è‡ªå‹•ã§Wikiæ›´æ–°
- GitHub Actions ã§ `src/modding/**` å¤‰æ›´æ™‚ã«ãƒˆãƒªã‚¬ãƒ¼

**è‡ªå‹•ãƒã‚°å–ã‚Šã‚·ã‚¹ãƒ†ãƒ **:
- æ“ä½œè¨˜éŒ² & å†ç”Ÿ
- ã‚·ãƒŠãƒªã‚ªãƒ†ã‚¹ãƒˆï¼ˆTOMLå®šç¾©ï¼‰
- ãƒã‚°æ¤œå‡ºâ†’GitHub Issueè‡ªå‹•ä½œæˆ

### M5å®Œäº†æ™‚: ãƒªãƒã‚¸ãƒˆãƒªåå¤‰æ›´

**ã‚²ãƒ¼ãƒ å: RisoFactory**ï¼ˆç†æƒ³ãƒ•ã‚¡ã‚¯ãƒˆãƒªãƒ¼ï¼‰

| ã‚¿ã‚¹ã‚¯ | å†…å®¹ |
|--------|------|
| R.1 | GitHubãƒªãƒã‚¸ãƒˆãƒªåã‚’ `riso-factory` ã«å¤‰æ›´ |
| R.2 | `Cargo.toml` ã® `name` ã‚’ `riso_factory` ã«å¤‰æ›´ |
| R.3 | ã‚³ãƒ¼ãƒ‰å†…ã® `idle_factory` å‚ç…§ã‚’æ›´æ–° |
| R.4 | ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚¿ã‚¤ãƒˆãƒ«ã‚’ã€ŒRisoFactoryã€ã«å¤‰æ›´ |
| R.5 | READMEã€ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ›´æ–° |

**åå‰ã®ç”±æ¥**:
- æ—¥æœ¬èª: ç†æƒ³ï¼ˆã‚Šãã†ï¼‰+ Factory
- ã‚¤ã‚¿ãƒªã‚¢èª: Riso = ç±³ & ç¬‘ã„
- ã€Œç¬‘ã„ã®å·¥å ´ã€ã¨ã„ã†ãƒ€ãƒ–ãƒ«ãƒŸãƒ¼ãƒ‹ãƒ³ã‚°

---

*æœ€çµ‚æ›´æ–°: 2026-01-11*
