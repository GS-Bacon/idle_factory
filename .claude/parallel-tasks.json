{
  "$schema": "./parallel-tasks.schema.json",
  "version": 1,
  "description": "並列実行可能なタスク定義。同じparallel_groupのタスクは同時実行可能",
  "tasks": [
    {
      "id": "fix-sprite-size",
      "name": "BUG-UI-1: スプライトサイズ修正",
      "parallel_group": "ui",
      "depends_on": [],
      "branch": "fix/sprite-size",
      "files": [
        "src/setup/ui/mod.rs"
      ],
      "status": "completed",
      "description": "アイテムスロット内のスプライト画像サイズが小さすぎる問題を修正"
    },
    {
      "id": "fix-catalog-icons",
      "name": "BUG-UI-2: カタログアイコン修正",
      "parallel_group": "ui",
      "depends_on": [],
      "branch": "fix/catalog-icons",
      "files": [
        "src/systems/inventory_ui.rs"
      ],
      "status": "completed",
      "description": "クリエイティブカタログのアイテムアイコンにスプライトを適用"
    },
    {
      "id": "fix-slot-background",
      "name": "BUG-UI-3: スロット背景色修正",
      "parallel_group": "ui",
      "depends_on": [],
      "branch": "fix/slot-background",
      "files": [
        "src/ui/widgets.rs"
      ],
      "status": "completed",
      "description": "スロット背景にアイテムの色が表示される問題を修正"
    },
    {
      "id": "fix-drag-display",
      "name": "BUG-UI-4: ドラッグ表示修正",
      "parallel_group": "ui",
      "depends_on": [],
      "branch": "fix/drag-display",
      "files": [
        "src/systems/inventory_ui.rs"
      ],
      "status": "completed",
      "description": "ドラッグ&ドロップ中にアイテムが表示されない問題を修正"
    },
    {
      "id": "hide-main-quest-tutorial",
      "name": "チュートリアル中メインクエスト非表示",
      "parallel_group": "ui",
      "depends_on": [],
      "branch": "feat/hide-main-quest-tutorial",
      "files": [
        "src/systems/quest.rs",
        "src/systems/tutorial.rs"
      ],
      "status": "completed",
      "description": "チュートリアル中にメインクエストを完全に非表示にする"
    },
    {
      "id": "fix-furnace-input",
      "name": "製錬炉搬入問題修正",
      "parallel_group": "machines",
      "depends_on": [],
      "branch": "fix/furnace-input",
      "files": [
        "src/machines/furnace.rs",
        "src/logistics/conveyor.rs"
      ],
      "status": "completed",
      "description": "製錬炉が鉱石の搬入を受け付けない問題を修正"
    },
    {
      "id": "tutorial-progress-bar",
      "name": "チュートリアル進捗バー",
      "parallel_group": "ui",
      "depends_on": [],
      "branch": "feat/tutorial-progress-bar",
      "files": [
        "src/setup/ui/mod.rs"
      ],
      "status": "completed",
      "description": "チュートリアルクエストで個数関係のものにプログレスバーを表示"
    },
    {
      "id": "simplify-biome-hud",
      "name": "バイオームHUD簡略化",
      "parallel_group": "ui",
      "depends_on": [],
      "branch": "feat/simplify-biome-hud",
      "files": [
        "src/systems/debug_ui.rs"
      ],
      "status": "completed",
      "description": "鉱石バイオーム表示をシンプルに、他UIと色を統一"
    },
    {
      "id": "coordinate-utils",
      "name": "タスク5: 座標変換ユーティリティ統一",
      "parallel_group": "core",
      "depends_on": [],
      "branch": "refactor/coordinate-utils",
      "files": [
        "src/utils.rs",
        "src/systems/targeting/guide.rs",
        "src/systems/targeting/conveyor.rs",
        "src/systems/targeting/highlight.rs",
        "src/logistics/conveyor.rs",
        "src/systems/block_operations/placement.rs",
        "src/systems/debug_ui.rs",
        "src/save/systems.rs",
        "src/systems/chunk.rs"
      ],
      "status": "completed",
      "description": "GridPos/WorldPos NewTypeパターンで座標変換を統一"
    },
    {
      "id": "commit-check",
      "name": "タスク9: 並列worktree重複コミット検出",
      "parallel_group": "core",
      "depends_on": [],
      "branch": "feat/commit-check",
      "files": [
        "scripts/parallel-run.sh"
      ],
      "status": "completed",
      "description": "finish時に同名コミットをチェック"
    },
    {
      "id": "machine-output",
      "name": "タスク6: 機械出力ロジック共通化",
      "parallel_group": "machines",
      "depends_on": [
        "coordinate-utils"
      ],
      "branch": "refactor/machine-output",
      "files": [
        "src/machines/mod.rs",
        "src/machines/output.rs",
        "src/machines/miner.rs",
        "src/machines/furnace.rs",
        "src/machines/crusher.rs"
      ],
      "status": "completed",
      "description": "3つの機械で共通の出力ロジックを抽出"
    },
    {
      "id": "machine-interaction",
      "name": "タスク7: 機械インタラクション共通化",
      "parallel_group": "machines",
      "depends_on": [
        "machine-output"
      ],
      "branch": "refactor/machine-interaction",
      "files": [
        "src/machines/mod.rs",
        "src/machines/interaction.rs",
        "src/machines/miner.rs",
        "src/machines/furnace.rs",
        "src/machines/crusher.rs"
      ],
      "status": "completed",
      "description": "3つの機械で共通のインタラクション処理を抽出"
    },
    {
      "id": "cursor-manager",
      "name": "タスク8: カーソル管理の集約",
      "parallel_group": "core",
      "depends_on": [
        "machine-interaction"
      ],
      "branch": "refactor/cursor-manager",
      "files": [
        "src/systems/cursor.rs",
        "src/ui/storage_ui.rs",
        "src/systems/inventory_ui.rs",
        "src/systems/player.rs",
        "src/systems/command/ui.rs"
      ],
      "status": "completed",
      "description": "カーソル操作を共通関数に統一"
    },
    {
      "id": "chunk-hashmap",
      "name": "タスク11: ChunkData HashMap削除",
      "parallel_group": "core",
      "depends_on": [],
      "branch": "refactor/chunk-hashmap",
      "files": [
        "src/world/mod.rs",
        "src/systems/chunk.rs"
      ],
      "status": "pending",
      "description": "blocks_mapの二重管理を解消しメモリ50%削減"
    },
    {
      "id": "greedy-meshing",
      "name": "タスク10: Greedy meshing実装",
      "parallel_group": "core",
      "depends_on": [
        "chunk-hashmap"
      ],
      "branch": "feat/greedy-meshing",
      "files": [
        "src/world/mod.rs"
      ],
      "status": "pending",
      "description": "連続面を結合して頂点数50%削減"
    },
    {
      "id": "diff-mesh",
      "name": "タスク12: 差分メッシュ更新",
      "parallel_group": "core",
      "depends_on": [
        "greedy-meshing"
      ],
      "branch": "feat/diff-mesh",
      "files": [
        "src/systems/chunk.rs"
      ],
      "status": "pending",
      "description": "隣接チャンクの境界面のみ更新"
    },
    {
      "id": "d0-step1",
      "name": "D.0 Step1: targeting/block_operations移行",
      "parallel_group": "core",
      "depends_on": [],
      "branch": "refactor/d0-step1",
      "files": [
        "src/systems/targeting/guide.rs",
        "src/systems/targeting/conveyor.rs",
        "src/systems/targeting/highlight.rs",
        "src/systems/block_operations/breaking.rs",
        "src/systems/block_operations/placement.rs"
      ],
      "status": "completed",
      "description": "Inventory Resource → LocalPlayer + Query移行 (5箇所)"
    },
    {
      "id": "d0-step2",
      "name": "D.0 Step2: machines/commands移行",
      "parallel_group": "core",
      "depends_on": [
        "d0-step1"
      ],
      "branch": "refactor/d0-step2",
      "files": [
        "src/machines/generic.rs",
        "src/systems/command/executor.rs",
        "src/systems/command/ui.rs"
      ],
      "status": "completed",
      "description": "Inventory Resource → LocalPlayer + Query移行 (3箇所)"
    },
    {
      "id": "d0-step3",
      "name": "D.0 Step3: hotbar移行",
      "parallel_group": "ui",
      "depends_on": [
        "d0-step2"
      ],
      "branch": "refactor/d0-step3",
      "files": [
        "src/systems/hotbar.rs"
      ],
      "status": "completed",
      "description": "Inventory Resource → LocalPlayer + Query移行 (4箇所)"
    },
    {
      "id": "d0-step4",
      "name": "D.0 Step4: inventory_ui移行",
      "parallel_group": "ui",
      "depends_on": [
        "d0-step3"
      ],
      "branch": "refactor/d0-step4",
      "files": [
        "src/systems/inventory_ui.rs"
      ],
      "status": "completed",
      "description": "Inventory Resource → LocalPlayer + Query移行 (5箇所)"
    },
    {
      "id": "d0-step5",
      "name": "D.0 Step5: save移行",
      "parallel_group": "core",
      "depends_on": [
        "d0-step4"
      ],
      "branch": "refactor/d0-step5",
      "files": [
        "src/save/systems.rs"
      ],
      "status": "completed",
      "description": "Inventory Resource → LocalPlayer + Query移行 (2箇所)"
    },
    {
      "id": "d0-step6",
      "name": "D.0 Step6: cleanup",
      "parallel_group": "core",
      "depends_on": [
        "d0-step5"
      ],
      "branch": "refactor/d0-step6",
      "files": [
        "src/player/inventory.rs"
      ],
      "status": "completed",
      "description": "sync_inventory_system削除、Inventory Resource削除"
    },
    {
      "id": "d5-texture",
      "name": "D.5.3: Blockbenchテクスチャ",
      "parallel_group": "core",
      "depends_on": [],
      "branch": "feat/d5-texture",
      "files": [
        "src/blockbench.rs"
      ],
      "status": "completed",
      "description": "base64 → Image変換（imageクレート使用）"
    },
    {
      "id": "d5-animation",
      "name": "D.5.4: Blockbenchアニメーション",
      "parallel_group": "core",
      "depends_on": [
        "d5-texture"
      ],
      "branch": "feat/d5-animation",
      "files": [
        "src/blockbench.rs"
      ],
      "status": "completed",
      "description": "keyframes, bones対応"
    }
  ],
  "parallel_groups": {
    "ui": {
      "description": "UIコンポーネント（互いに独立）",
      "max_concurrent": 2
    },
    "logistics": {
      "description": "物流システム（conveyor等）",
      "max_concurrent": 1
    },
    "machines": {
      "description": "機械システム",
      "max_concurrent": 2
    },
    "core": {
      "description": "コアシステム（単独実行推奨）",
      "max_concurrent": 1
    }
  },
  "conflict_rules": [
    {
      "description": "同じファイルを触るタスクは並列不可",
      "type": "file_overlap"
    },
    {
      "description": "依存関係があるタスクは順次実行",
      "type": "dependency"
    }
  ]
}
